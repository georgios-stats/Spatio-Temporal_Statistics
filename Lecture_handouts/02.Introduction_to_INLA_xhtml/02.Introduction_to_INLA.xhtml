<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.3.7" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>LyX Document</title>
<style type='text/css'>
/* LyX Provided Styles */
mstyle.math { font-style: italic; }

/* Layout-provided Styles */
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
h3.subsection_ {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h2.section {
font-weight: normal;
font-style: normal;
font-variant: small-caps;
font-size: medium;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.theorem {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.theorem_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proposition {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proposition_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.proof {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.proof_label {
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.example {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.example_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
div.solution_ {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.solution__label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h3.subsection {
font-weight: bold;
font-size: medium;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
span.subsection_label {
font-weight: normal;
font-size: medium;

}
div.note {
font-style: normal;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.note_label {
font-weight: normal;
font-style: italic;
font-variant: normal;
font-size: medium;

}
div.assumption {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.assumption_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
dl.description dt { font-weight: bold; }
div.algorithm {
font-style: italic;
font-variant: normal;
font-size: medium;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
text-align: left;

}
span.algorithm_label {
font-weight: bold;
font-style: normal;
font-variant: normal;
font-size: medium;

}
h5.paragraph_ {
font-weight: bold;
font-size: medium;
margin-top: 0.4ex;
text-align: left;

}
div.Shadowbox { border: solid gray medium; border-bottom: solid black 1ex; border-right: solid black 1ex; padding: 0.5ex; }
span.flex_url {
font-family: monospace;
}
div.Frameless { margin: 1em; }
div.marginal {
	border: 2px solid black;
	padding: 1ex;
	margin: 1ex;
	background-color: #F0F0F0;
	float:right;
	font-size: small;
	font-weight: medium;
	font-family: serif;
	font-variant: normal;
	font-style: normal;
}


</style>
</head>
<body dir="auto">


<div class="standard" id='magicparlabel-1'><div class='Shadowbox'><div class="plain_layout" id='magicparlabel-10'>Spatio-temporal statistics (MATH4341)&nbsp;&nbsp;Michaelmas term, 2023<div style='height:3ex'></div></div>

<div class="plain_layout" style='text-align: center;' id='magicparlabel-11'> Handout 2: Introduction to INLA (R-INLA) <div style='height:3ex'></div></div>

<div class="plain_layout" id='magicparlabel-32'>Lecturer &amp; author: Georgios P. Karagiannis <a href="georgios.karagiannis@durham.ac.uk">georgios.karagiannis@durham.ac.uk</a></div>

<div class="plain_layout" id='magicparlabel-33'><hr />

<div style='height:3ex'></div></div>
<h3 class="subsection_" id='magicparlabel-34'>Aim</h3>
<div class="plain_layout" id='magicparlabel-35'>To introduce Laplace approximation, and Integrated Laplace Approximation computational methods. To introduce </div>

<div class="plain_layout" id='magicparlabel-36'><hr />

</div>
<h3 class="subsection_" id='magicparlabel-37'>Reading&nbsp;list&nbsp;&amp;&nbsp;references:</h3>

<ol class="enumerate" id='magicparlabel-38'><li class="enumerate_item">Blangiardo, M., &amp; Cameletti, M. (2015). Spatial and spatio-temporal Bayesian models with R-INLA. John Wiley &amp; Sons.

<ul class="itemize" id='magicparlabel-39'><li class="itemize_item">Ch. 4.6-4.9; pp.104-126</li>
</ul>
</li><li class="enumerate_item">Turkman, M. A. A., Paulino, C. D., &amp; MÃ¼ller, P. (2019). Computational Bayesian statistics: an introduction (Vol. 11). Cambridge University Press.

<ul class="itemize" id='magicparlabel-62'><li class="itemize_item">Ch. 8</li>
</ul>
</li><li class="enumerate_item">Rue, H., Martino, S., &amp; Chopin, N. (2009). Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations. Journal of the Royal Statistical Society Series B: Statistical Methodology, 71(2), 319-392.</li>
</ol>
</div></div>


<h2 class="section" id='magicparlabel-73'><span class="section_label">1</span> Laplace Approximation (LA)</h2>

<div class="proposition" id='magicparlabel-74'><div class="proposition_item"><span class="proposition_label">Proposition 1.</span>
<a id="note_Assume___Consider" />
 Consider integral <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>I</mi><mo>=</mo><mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>n</mi><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi> &theta; </mi>
  </mrow>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>. Laplace approximation (LA) method produces approximation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>I</mi><mo> &ap; </mo>
   <mover>
    <mrow><mi>I</mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover>
  </mrow>
 </mrow></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mi>I</mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>2</mn><mi> &pi; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mfrac>
      <mrow><mi>d</mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
    </mrow>
   </msup>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &Sigma; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
    </mrow>
   </msup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>n</mi><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mover>
     <mrow><mi> &theta; </mi>
     </mrow><mo stretchy="true">&circ;</mo>
    </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi> &theta; </mi>
   </mrow><mo stretchy="true">&circ;</mo>
  </mover>
 </mrow></math> is the maximum of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> &Sigma; </mo><mo>=</mo><mo>-</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>H</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>with Hessian <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>H</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mover>
    <mrow><mi> &theta; </mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mrow><mi> &part; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
       <mrow>
        <mrow><mi> &part; </mi>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mi> &part; </mi>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo>
      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>. </div>

<div class="proof" id='magicparlabel-75'><div class="proof_item"><span class="proof_label">Proof.</span>
Sketch of the proof. Take 2nd order Taylor expansion of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> around <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi> &theta; </mi>
   </mrow><mo stretchy="true">&circ;</mo>
  </mover>
 </mrow></math> i.e.<a id="eq__10" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ap; </mo><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mover>
      <mrow><mi> &theta; </mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>-</mo>
      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </mfrac>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi> &theta; </mi><mo>-</mo>
        <mover>
         <mrow><mi> &theta; </mi>
         </mrow><mo stretchy="true">&circ;</mo>
        </mover>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow><mi> &top; </mi>
      </mrow>
     </msup><mi>H</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mover>
      <mrow><mi> &theta; </mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>-</mo>
      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(1.1)
   </mtd>
  </mtr>
 </mtable></math>then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd><mi>I</mi>
   </mtd>
   <mtd>
    <mrow><mo> &ap; </mo><mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>n</mi><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mi>n</mi>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &theta; </mi><mo>-</mo>
         <mover>
          <mrow><mi> &theta; </mi>
          </mrow><mo stretchy="true">&circ;</mo>
         </mover>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msup><mi>H</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &theta; </mi><mo>-</mo>
       <mover>
        <mrow><mi> &theta; </mi>
        </mrow><mo stretchy="true">&circ;</mo>
       </mover>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>n</mi><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </mfrac>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi> &theta; </mi><mo>-</mo>
         <mover>
          <mrow><mi> &theta; </mi>
          </mrow><mo stretchy="true">&circ;</mo>
         </mover>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msup>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msup>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mo>-</mo><mi>n</mi><mi>H</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mover>
            <mrow><mi> &theta; </mi>
            </mrow><mo stretchy="true">&circ;</mo>
           </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
         <mrow>
          <mrow><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
        </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>1</mn>
        </mrow>
       </mrow>
      </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &theta; </mi><mo>-</mo>
       <mover>
        <mrow><mi> &theta; </mi>
        </mrow><mo stretchy="true">&circ;</mo>
       </mover>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>n</mi><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mover>
       <mrow><mi> &theta; </mi>
       </mrow><mo stretchy="true">&circ;</mo>
      </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mn>2</mn><mi> &pi; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow>
       <mfrac>
        <mrow><mi>d</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msup>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msup>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mo>-</mo><mi>n</mi><mi>H</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <mover>
            <mrow><mi> &theta; </mi>
            </mrow><mo stretchy="true">&circ;</mo>
           </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
         <mrow>
          <mrow><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
        </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msup>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> </div>


<div class="standard" id='magicparlabel-82'>Given regularity conditions related to the Taylor expansions <a href="#eq__10">(1.1)</a>, it can be shown that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>I</mi><mo>=</mo>
   <mover>
    <mrow><mi>I</mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>+</mo><mi>O</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>n</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> (not discussed here).</div>
</div>

</div>

<div class="standard" id='magicparlabel-88'><br />

</div>

<div class="example" id='magicparlabel-89'><div class="example_item"><span class="example_label">Example 2.</span>
<a id="exa_Consider_posterior_expectation" />
Consider posterior expectation <a id="eq__19" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mstyle mathvariant='normal'><mi>E</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi>
    </mrow>
   </mtd>
   <mtd>(1.2)
   </mtd>
  </mtr>
 </mtable></math>of a function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of the parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> given observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>z</mi>
 </mrow></math>. Laplace method can produce approximation<math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ap; </mo>
   <mover>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'><mi>E</mi>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&Hat;</mo>
   </mover>
  </mrow>
 </mrow></math><a id="eq__15" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow>
       <mrow>
        <mstyle mathvariant='normal'><mi>E</mi>
        </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&Hat;</mo>
     </mover><mo>=</mo>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mfrac>
        <mrow>
         <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <msup>
           <mrow><mo> &Sigma; </mo>
           </mrow>
           <mrow><mo>*</mo>
           </mrow>
          </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &Sigma; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
       </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msup><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>n</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msup>
        <mrow><mi>L</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow>
         <mover>
          <mrow><mi> &theta; </mi>
          </mrow><mo stretchy="true">&circ;</mo>
         </mover>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mover>
        <mrow><mi> &theta; </mi>
        </mrow><mo stretchy="true">&circ;</mo>
       </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(1.3)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi> &theta; </mi>
   </mrow><mo stretchy="true">&circ;</mo>
  </mover>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo> &Sigma; </mo>
 </mrow></math> are the mode and minus the inverse Hessian of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>/</mo><mi>n</mi>
  </mrow>
 </mrow></math> while <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow>
    <mover>
     <mrow><mi> &theta; </mi>
     </mrow><mo stretchy="true">&circ;</mo>
    </mover>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mo> &Sigma; </mo>
   </mrow>
   <mrow><mo>*</mo>
   </mrow>
  </msup>
 </mrow></math> are the mode and minus the inverse Hessian of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>L</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>/</mo><mi>n</mi>
  </mrow>
 </mrow></math>. </div>

<div class="solution_" id='magicparlabel-98'><div class="solution__item"><span class="solution__label">Solution.</span>
(Sketch of the solution) It is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mrow><mo> &int; </mo><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi> &theta; </mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi> &theta; </mi>
     </mrow>
    </mrow>
   </mfrac><mo>=</mo>
   <mfrac>
    <mrow>
     <mrow><mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>n</mi>
       <msup>
        <mrow><mi>L</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi> &theta; </mi>
     </mrow>
    </mrow>
    <mrow>
     <mrow><mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>n</mi>
       <msup>
        <mrow><mi>L</mi>
        </mrow>
        <mrow>
        </mrow>
       </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi> &theta; </mi>
     </mrow>
    </mrow>
   </mfrac><mover accent='false'><mo> &ap; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &starf; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
</mover>
   <mfrac>
    <mrow>
     <mrow>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mn>2</mn><mi> &pi; </mi><mi>n</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow>
        <mrow><mi>d</mi><mo>/</mo><mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <msqrt>
       <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msup>
         <mrow><mo> &Sigma; </mo>
         </mrow>
         <mrow><mo>*</mo>
         </mrow>
        </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msqrt><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>n</mi>
       <msup>
        <mrow><mi>L</mi>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow>
         <mover>
          <mrow><mi> &theta; </mi>
          </mrow><mo stretchy="true">&circ;</mo>
         </mover>
        </mrow>
        <mrow><mo>*</mo>
        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
    <mrow>
     <mrow>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mn>2</mn><mi> &pi; </mi><mi>n</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow>
        <mrow><mi>d</mi><mo>/</mo><mn>2</mn>
        </mrow>
       </mrow>
      </msup>
      <msqrt>
       <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <msup>
         <mrow><mo> &Sigma; </mo>
         </mrow>
         <mrow>
         </mrow>
        </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msqrt><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>n</mi><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <msup>
        <mrow>
         <mover>
          <mrow><mi> &theta; </mi>
          </mrow><mo stretchy="true">&circ;</mo>
         </mover>
        </mrow>
        <mrow>
        </mrow>
       </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </mfrac>
  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &starf; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> is by applying Proposition <a href="#note_Assume___Consider">1</a> once at the top and once at the bottom of the fraction. Then the result follows.</div>
<div class="solution__item"></div>
<div class="solution__item">Under regularity conditions related to Taylor expansion (not discussed here), it is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mover>
    <mrow>
     <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &theta; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo>|</mo><mi>z</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&Hat;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>+</mo>
    <msub>
     <mrow><mi>O</mi>
     </mrow>
     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>n</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> where the lower index indicates the dependence of the constant on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math>. </div>
</div>

</div>


<div class="example" id='magicparlabel-122'><div class="example_item"><span class="example_label">Example 3.</span>
<a id="exa_Consider_posterior_expectation_1" />
Consider the marginal posterior density of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo> &isin; </mo>
   <mstyle mathvariant='double-struck'><mi>R</mi>
   </mstyle>
  </mrow>
 </mrow></math><a id="eq__19_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(1.4)
   </mtd>
  </mtr>
 </mtable></math>under a Bayesian model with observable <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>z</mi><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and unknown parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &isin; </mo>
   <msup>
    <mrow>
     <mstyle mathvariant='double-struck'><mi>R</mi>
     </mstyle>
    </mrow>
    <mrow><mi>d</mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> with <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Laplace method can produce approximation <a id="eq__15_1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>|</mo><mi>z</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow><mo stretchy="true">&Hat;</mo>
     </mover><mo>=</mo>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mfrac>
        <mrow>
         <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msup>
            <mrow><mo> &Sigma; </mo>
            </mrow>
            <mrow><mo>*</mo>
            </mrow>
           </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn><mi> &pi; </mi><mi>n</mi><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &Sigma; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
       </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msup>
     <mfrac>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow>
           <mover>
            <mrow><mi> &theta; </mi>
            </mrow><mo stretchy="true">&circ;</mo>
           </mover>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>z</mi><mo>|</mo>
           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub><mo>,</mo>
           <msub>
            <mrow>
             <mover>
              <mrow><mi> &theta; </mi>
              </mrow><mo stretchy="true">&circ;</mo>
             </mover>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mover>
         <mrow><mi> &theta; </mi>
         </mrow><mo stretchy="true">&circ;</mo>
        </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>z</mi><mo>|</mo>
           <mover>
            <mrow><mi> &theta; </mi>
            </mrow><mo stretchy="true">&circ;</mo>
           </mover>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(1.5)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi> &theta; </mi>
   </mrow><mo stretchy="true">&circ;</mo>
  </mover>
 </mrow></math> is the maximizer of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>z</mi><mo>|</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo>,</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msub>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> ,</div>
<div class="standard" id='magicparlabel-131'><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo> &Sigma; </mo>
 </mrow></math> is the minus Hessian of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>n</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> , </div>

<div class="standard" id='magicparlabel-132'><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow><mi> &theta; </mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is the maximizer of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>z</mi><mo>|</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo>,</mo><mo> &sdot; </mo>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo>,</mo><mo> &sdot; </mo>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> ,</div>

<div class="standard" id='magicparlabel-133'><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mo> &Sigma; </mo>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is the minus Hessian of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>n</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo><mo> &sdot; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo><mo> &sdot; </mo>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> </div>

<div class="solution_" id='magicparlabel-138'><div class="solution__item"><span class="solution__label">Solution.</span>
(Sketch of the solution) It is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>z</mi><mo>|</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle>
        <msub>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>z</mi><mo>|</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &theta; </mi>
       </mrow>
      </mrow>
     </mfrac><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>n</mi>
         <msubsup>
          <mrow><mi>L</mi>
          </mrow>
          <mrow>
           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub>
          </mrow>
          <mrow><mo>*</mo>
          </mrow>
         </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle>
        <msub>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> &int; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>n</mi>
         <msup>
          <mrow><mi>L</mi>
          </mrow>
          <mrow>
          </mrow>
         </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mstyle mathvariant='normal'><mi>d</mi>
        </mstyle><mi> &theta; </mi>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mover accent='false'><mo> &ap; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &starf; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
</mover>
     <msup>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mfrac>
        <mrow>
         <mrow><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msup>
            <mrow><mo> &Sigma; </mo>
            </mrow>
            <mrow><mo>*</mo>
            </mrow>
           </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow><mn>2</mn><mi> &pi; </mi><mi>n</mi><mo> det </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &Sigma; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
       </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
      <mrow>
       <mfrac>
        <mrow><mn>1</mn>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </mfrac>
      </mrow>
     </msup>
     <mfrac>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo>,</mo>
         <msub>
          <mrow>
           <mover>
            <mrow><mi> &theta; </mi>
            </mrow><mo stretchy="true">&circ;</mo>
           </mover>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>z</mi><mo>|</mo>
           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub><mo>,</mo>
           <msub>
            <mrow>
             <mover>
              <mrow><mi> &theta; </mi>
              </mrow><mo stretchy="true">&circ;</mo>
             </mover>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

           <msub>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>1</mn>
            </mrow>
           </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mover>
         <mrow><mi> &theta; </mi>
         </mrow><mo stretchy="true">&circ;</mo>
        </mover>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>z</mi><mo>|</mo>
           <mover>
            <mrow><mi> &theta; </mi>
            </mrow><mo stretchy="true">&circ;</mo>
           </mover>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>L</mi>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msup>
    <mrow><mi>n</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msup>
    <mrow><mi>n</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. Here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &starf; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math> results by applying Proposition <a href="#note_Assume___Consider">1</a> once at the top and once at the bottom of the fraction. Then the result is implied. </div>
<div class="solution__item"></div>
<div class="solution__item">Under regularity conditions related to Taylor expansion (not discussed here), it is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mover>
    <mrow>
     <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi> &theta; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo>|</mo><mi>z</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow><mo stretchy="true">&Hat;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>1</mn><mo>+</mo>
    <msub>
     <mrow><mi>O</mi>
     </mrow>
     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <msup>
     <mrow><mi>n</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>1</mn>
      </mrow>
     </mrow>
    </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> where the lower index indicates the dependence of the constant on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math>. </div>
</div>

</div>
<h2 class="section" id='magicparlabel-151'><span class="section_label">2</span> Integrated Nested Laplace Approximation (INLA)</h2>
<h3 class="subsection" id='magicparlabel-152'><span class="subsection_label">2.1</span> Motivations</h3>

<div class="note" id='magicparlabel-153'><div class="note_item"><span class="note_label">Note 4.</span>
Integrated Nested Laplace Approximation (INLA) can directly compute very accurate approximations to posterior marginals and summary statistics of statistical models with a specific type (such as those discussed in the module) even if they are high-dimensional or involve large datasets. In such models, MCMC methods may need hours or days to run, which INLA can provide more precise estimates in seconds or minutes for a certain type of models we will discuss.  </div>
</div>
<h3 class="subsection" id='magicparlabel-163'><span class="subsection_label">2.2</span> Where it can be applied; implementations</h3>

<div class="standard" id='magicparlabel-164'><br />

</div>

<div class="note" id='magicparlabel-165'><div class="note_item"><span class="note_label">Note 5.</span>
INLA is suitable to facilitate Bayesian inference in spatial statistical problems related to Latent Gaussian Models (LGM). </div>
</div>

<div class="standard" id='magicparlabel-166'><br />

</div>

<div class="note" id='magicparlabel-167'><div class="note_item"><span class="note_label">Note 6.</span>
The class of Latent Gaussian Models (LGM) can be represented in a three level hierarchical model structure. The first level is the sampling model where the observations <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>z</mi><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo><mn>...</mn><mo>,</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mi> &top; </mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> can be assumed to be conditionally independent, given a latent random field <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo><mn>...</mn><mo>,</mo>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mi> &top; </mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> and hyper-parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math>, i.e. <a id="eq__17" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>1</mn>
      </mrow>
     </msub><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mn>.</mn>
    </mrow>
   </mtd>
   <mtd>(2.1)
   </mtd>
  </mtr>
 </mtable></math>The second level assumes that <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> follows a multivariate Gaussian distribution (Essentially a Gaussian random field) given hyper-parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msub>
 </mrow></math> , i.e. <a id="eq__1" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi><mo> &sim; </mo>
     <mstyle mathvariant='normal'><mi>N</mi>
     </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &mu; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>Q</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>1</mn>
        </mrow>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.2)
   </mtd>
  </mtr>
 </mtable></math> The third level (relevant only to fully Bayesian statistical models) specifies a prior on the unknown parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo>,</mo>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mi> &top; </mi>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>, i.e.<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></div>
</div>



<div class="standard" id='magicparlabel-174'><br />

</div>

<div class="assumption" id='magicparlabel-175'><div class="assumption_item"><span class="assumption_label">Assumption 7.</span>
For the computational purposes of INLA, we make assumption that <a href="#eq__1">(2.2)</a> is defined wrt an undirected graph <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='script'><mi>G</mi>
   </mstyle><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <mstyle mathvariant='script'><mi>V</mi>
    </mstyle><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow><mn>1</mn><mo>,</mo><mn>...</mn><mi>n</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo>,</mo>
    <mstyle mathvariant='script'><mi>E</mi>
    </mstyle>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> such that <a id="eq__2" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi>y</mi>
      </mrow>
      <mrow><mi>l</mi>
      </mrow>
     </msub><mi> &bottom; </mi>
     <msub>
      <mrow><mi>y</mi>
      </mrow>
      <mrow><mi>m</mi>
      </mrow>
     </msub><mo>|</mo>
     <msub>
      <mrow><mi>y</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

        <mrow><mi>l</mi><mo>,</mo><mi>m</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

       </mrow>
      </mrow>
     </msub><mo>,</mo><mspace width="6px" /><mspace width="6px" /><mspace width="6px" /><mspace width="6px" /><mi> &forall; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

     <mrow><mi>l</mi><mo>,</mo><mi>m</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo> &notin; </mo>
     <mstyle mathvariant='script'><mi>E</mi>
     </mstyle>
    </mrow>
   </mtd>
   <mtd>(2.3)
   </mtd>
  </mtr>
 </mtable></math>This leads to sparse precision matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>Q</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> because<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mi>l</mi>
    </mrow>
   </msub><mi> &bottom; </mi>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mi>m</mi>
    </mrow>
   </msub><mo>|</mo>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

      <mrow><mi>l</mi><mo>,</mo><mi>m</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

     </mrow>
    </mrow>
   </msub><mo> &harr; </mo>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow><mi>Q</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mi>l</mi><mo>,</mo><mi>m</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math> This makes <a href="#eq__1">(2.2)</a> be a Gaussian Markov Random Field (GMRF). </div>
</div>

<div class="standard" id='magicparlabel-176'><br />

</div>

<div class="note" id='magicparlabel-177'><div class="note_item"><span class="note_label">Note 8.</span>
The LGM (under consideration) is summarized to <a id="eq__4" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &theta; </mi>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi>&nbsp;<mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi>&nbsp;<mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;
      <mstyle class='math'><mi>z</mi>
      </mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mstyle>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo>
     <msub>
      <mrow><mo> Pr </mo>
      </mrow>
      <mrow>
       <mstyle mathvariant='script'><mi>G</mi>
       </mstyle>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>G</mi><mi>M</mi><mi>R</mi><mi>F</mi>&nbsp;<mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi>&nbsp;<mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;
      <mstyle class='math'><mi>y</mi>
      </mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mstyle>
   </mtd>
   <mtd>(2.4)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mi> &theta; </mi>
   </mtd>
   <mtd>
    <mrow><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mstyle mathvariant='normal'><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>h</mi><mi>y</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>p</mi><mi>r</mi><mi>i</mi><mi>o</mi><mi>r</mi>&nbsp;<mi>f</mi><mi>o</mi><mi>r</mi>&nbsp;
      <mstyle class='math'><mi> &theta; </mi>
      </mstyle>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mstyle>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
 </mtable></math> </div>
</div>

<div class="standard" id='magicparlabel-178'><br />

</div>

<div class="note" id='magicparlabel-179'><div class="note_item"><span class="note_label">Note 9.</span>
The joint posterior probability model is<a id="eq__12" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &vprop; </mo>
     <msubsup>
      <mrow><mo> &prod; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(2.5)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo> &vprop; </mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo>-</mo>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </mfrac>
      <msup>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>-</mo><mi> &mu; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
       <mrow><mi> &top; </mi>
       </mrow>
      </msup><mi>Q</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi>y</mi><mo>-</mo><mi> &mu; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
      <msubsup>
       <mrow><mo> &sum; </mo>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
        </mrow>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msubsup><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>|</mo>
        <msub>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mi>i</mi>
         </mrow>
        </msub><mo>,</mo><mi> &theta; </mi>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
 </mtable></math> and hence there is interest in computing the marginal densities and expectations of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo><mi>z</mi>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo><mi>z</mi>
  </mrow>
 </mrow></math> as well as predictions of unseen <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math>'s.</div>
<div class="note_item"></div>
</div>

<div class="assumption" id='magicparlabel-185'><div class="assumption_item"><span class="assumption_label">Assumption 10.</span>
For INLA to perform most efficiently (fast) and accurately (due to approximations), we make the following critical assumptions:</div>

<ol class="enumerate" id='magicparlabel-186'><li class="enumerate_item"><i>The number of hyperparameters <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> is small, typically <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>2</mn>
 </mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>5</mn>
 </mrow></math>, but not exceeding <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>20</mn>
 </mrow></math>.</i></li>
<li class="enumerate_item"><i><math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is required to be a GMRF (or close to one) when the dimension <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> is high <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

  <mrow><mn>103</mn><mo>â</mo><mn>105</mn>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

 </mrow></math>.</i></li>
<li class="enumerate_item"><i>The data <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> are mutually conditionally independent of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math>, implying that each observation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> only depends on one component of the latent field, for example, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>. Most components of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> will not be observed.</i></li>
</ol>
</div>

<div class="standard" id='magicparlabel-189'><br />

</div>

<div class="note" id='magicparlabel-190'><div class="note_item"><span class="note_label">Note 11.</span>
LGM in <a href="#eq__4">(2.4)</a> can be specified as a special case of a regression model whose response <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> are assumed to follow an exponential family distribution with mean <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>=</mo>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> linked to a Gaussian linear predictor <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> via a known link function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &mu; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> and <a id="eq__20" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &eta; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo>=</mo><mi> &alpha; </mi><mo>+</mo>
     <msub>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi> &beta; </mi>
      </mrow>
      <mrow><mi>j</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>x</mi>
      </mrow>
      <mrow>
       <mrow><mi>j</mi><mo>,</mo><mi>i</mi>
       </mrow>
      </mrow>
     </msub><mo>+</mo>
     <msub>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi>u</mi>
      </mrow>
      <mrow>
       <mrow><mi>k</mi><mi>i</mi>
       </mrow>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
     <msub>
      <mrow><mi> &epsi; </mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(2.6)
   </mtd>
  </mtr>
 </mtable></math>  where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &alpha; </mi>
 </mrow></math> is the intercept, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &beta; </mi>
   </mrow>
   <mrow><mi>j</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> are coefficients (fixed effects) of covariates <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi>x</mi>
   </mrow>
   <mrow>
    <mrow><mi>j</mi><mo>,</mo><mi>i</mi>
    </mrow>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>f</mi>
    </mrow>
    <mrow><mi>k</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> are unknown functions of covariates <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>u</mi>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &epsi; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> is a random error. Casting it as an LGM, we can set <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &alpha; </mi><mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>j</mi>
     </mrow>
    </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <mrow>
     <msub>
      <mrow><mi>f</mi>
      </mrow>
      <mrow><mi>k</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi>u</mi>
      </mrow>
      <mrow>
       <mrow><mi>k</mi><mi>i</mi>
       </mrow>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msub>
     <mrow><mi> &eta; </mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is the latent field in <a href="#eq__4">(2.4)</a> (for conveniency, we consider <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> instead of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &epsi; </mi>
 </mrow></math>), and the rest hyperparameters (to be learned) constitute <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-199'><br />

</div>

<div class="note" id='magicparlabel-200'><div class="note_item"><span class="note_label">Note 12.</span>
Consequently the class LGM involves many computationally challenging models, such as the spatial models (geostatistical, latent, point process), the associated spatio-temporal models, and the mixed effect GLM. </div>
</div>

<div class="standard" id='magicparlabel-201'><br />

</div>
<h3 class="subsection" id='magicparlabel-202'><span class="subsection_label">2.3</span> The general idea</h3>

<div class="note" id='magicparlabel-203'><div class="note_item"><span class="note_label">Note 13.</span>
We are interested in computing the following marginals of <a href="#eq__12">(2.5)</a> <a id="eq__5" />
<a id="eq__6" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> &int; </mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi>y</mi>
     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mi>j</mi>
       </mrow>
      </mrow>
     </msub><mo>=</mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mi>j</mi>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(2.7)
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> &int; </mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi>y</mi>
      </mrow>
      <mrow>
       <mrow><mo>-</mo><mi>i</mi>
       </mrow>
      </mrow>
     </msub>
     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi><mo>=</mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi>
    </mrow>
   </mtd>
   <mtd>(2.8)
   </mtd>
  </mtr>
 </mtable></math> where integrals <a href="#eq__5">(2.8)</a> and <a href="#eq__6">(2.8)</a> can be of high dimentionality wrt <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math>. </div>
</div>

<div class="standard" id='magicparlabel-204'><br />

</div>

<div class="note" id='magicparlabel-205'><div class="note_item"><span class="note_label">Note 14.</span>
For the approximation of <a href="#eq__5">(2.8)</a> and <a href="#eq__6">(2.8)</a>, INLA involves three steps: evaluation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> via Laplace approx, evaluation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> via Laplace approx, and finally numerical integration.</div>
</div>

<div class="standard" id='magicparlabel-206'><br />

</div>

<div class="note" id='magicparlabel-207'><div class="note_item"><span class="note_label">Note 15.</span>
<a id="note_Notice_that_at" />
To compute an approximate for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, notice that at any point <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>y</mi>
 </mrow></math> it is <a id="eq__7" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>,</mo><mi> &theta; </mi><mo>|</mo><mi>z</mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac><mo> &vprop; </mo>
     <mfrac>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>(2.9)
   </mtd>
  </mtr>
 </mtable></math>Unlike the numerator, the denumerator is not available in closed form and is hard to compute. INLA employs the approximation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> by a multivariate Gaussian distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'><mi>G</mi>
     </mstyle>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> whose mean is the mode <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi>y</mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and covariance matrix is the minus inverse Hessian at that mode. Essentially, the approximation of <a href="#eq__7">(2.9)</a> at a specific value of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> is <a id="eq__8" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mfrac>
        <mrow>
         <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &theta; </mi>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow>
          <msub>
           <mrow>
            <mover>
             <mrow><mo> Pr </mo>
             </mrow><mo stretchy="true">&Tilde;</mo>
            </mover>
           </mrow>
           <mrow>
            <mstyle mathvariant='normal'><mi>G</mi>
            </mstyle>
           </mrow>
          </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
       </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi>y</mi><mo>=</mo>
        <msup>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mo>*</mo>
         </mrow>
        </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(2.10)
   </mtd>
  </mtr>
 </mtable></math> which is equivalent to the Laplace approximation method for marginal densities. </div>
</div>

<div class="standard" id='magicparlabel-212'><br />

</div>

<div class="note" id='magicparlabel-213'><div class="note_item"><span class="note_label">Note 16.</span>
<a id="note_To_compute_an" />
To compute an approximate for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at each <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> there are three main approaches:</div>

<dl class='description' id='magicparlabel-214'><dt class="description_label">Gaussian&nbsp;approximation&nbsp;approach.</dt>
<dd class="description_item"> Compute the marginal from the Gaussian approximation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'><mi>G</mi>
     </mstyle>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> in Note <a href="#note_Notice_that_at">15</a>. This is fast but not generally accurate. </dd>
<dt class="description_label">Laplace&nbsp;approximation</dt>
<dd class="description_item"> Similar to Note <a href="#note_Notice_that_at">15</a>, compute <a id="eq__9" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mfrac>
        <mrow>
         <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &theta; </mi>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
        <mrow>
         <mrow>
          <msub>
           <mrow>
            <mover>
             <mrow><mo> Pr </mo>
             </mrow><mo stretchy="true">&Tilde;</mo>
            </mover>
           </mrow>
           <mrow>
            <mstyle mathvariant='normal'><mi>G</mi>
            </mstyle>
           </mrow>
          </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

          <mrow>
           <msub>
            <mrow><mi>y</mi>
            </mrow>
            <mrow>
             <mrow><mo>-</mo><mi>i</mi>
             </mrow>
            </mrow>
           </msub><mo>|</mo>
           <msub>
            <mrow><mi>y</mi>
            </mrow>
            <mrow><mi>i</mi>
            </mrow>
           </msub><mo>,</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
          </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </mrow>
       </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi>y</mi><mo>=</mo>
        <msup>
         <mrow><mi>y</mi>
         </mrow>
         <mrow><mo>*</mo>
         </mrow>
        </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(2.11)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'><mi>G</mi>
     </mstyle>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mi>i</mi>
      </mrow>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>,</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is a multivariate Gaussian distribution whose mean is the mode <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi>y</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mi>i</mi>
     </mrow>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msubsup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and covariance matrix is the minus inverse Hessian at that mode. It is more accurate than the previous one but computational demanding because it requires the the re-calculation of the precision matrix for each <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>y</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math>.</dd>
<dt class="description_label">Simplified&nbsp;Laplace&nbsp;approximation</dt>
<dd class="description_item"> It builds on third order Taylor series expansions both in numerator and denumerator of <a href="#eq__9">(2.11)</a>, which improves the approximation wrt asymmetry. We skip the mathematical details here. It has improved accuracy. </dd>
</dl>
</div>
<h3 class="subsection" id='magicparlabel-217'><span class="subsection_label">2.4</span> The schematic of the procedure</h3>

<div class="algorithm" id='magicparlabel-218'><div class="algorithm_item"><span class="algorithm_label">Algorithm 17.</span>
Summing up, the INLA method proceeds as follows:</div>
</div>

<ol class="enumerate" id='magicparlabel-219'><li class="enumerate_item">Explore the space of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math>. 

<ol class="enumerate" id='magicparlabel-220'><li class="enumerate_item">Locate a collection of points <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>;</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> in the area of high density of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </li>
<li class="enumerate_item">Find the mode of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </li>
</ol>
</li><li class="enumerate_item">Compute approximation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at points <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>;</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> by using <a href="#eq__8">(2.10)</a>.</li>
<li class="enumerate_item">Compute approximation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at points <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>;</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mi>K</mi>
  </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> by using the Laplace approximation in <a href="#eq__9">(2.11)</a> or the simplified Laplace approximation, or the Gaussian approximation, as said in Note <a href="#note_To_compute_an">16</a>.</li>
<li class="enumerate_item">Compute the approximation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <a href="#eq__6">(2.8)</a> via standard numerical approximation as<a id="eq__14" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>k</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>K</mi>
      </mrow>
     </msubsup>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi><mo>,</mo>
      <msup>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msup>
      <mrow><mo> &Delta; </mo>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(2.12)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mo> &Delta; </mo>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> as weights depending on the locations <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> and the numerical integration scheme. If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> are equal-distant then <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mo> &Delta; </mo>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> .</li>
<li class="enumerate_item">Compute the approximation <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <a href="#eq__6">(2.8)</a> via standard numerical approximation as<a id="eq__13" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mi>j</mi>
       </mrow>
      </msub><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>k</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>K</mi>
      </mrow>
     </msubsup>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub><mo>,</mo>
      <msubsup>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mi>j</mi>
        </mrow>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msubsup><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msup>
      <mrow><mo> &Delta; </mo>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(2.13)
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mo> &Delta; </mo>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> as weights depending on the locations <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msubsup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow>
    <mrow><mo>-</mo><mi>j</mi>
    </mrow>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> and the numerical integration scheme. If <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> are equal-distant then <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mo> &Delta; </mo>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo><mn>1</mn>
  </mrow>
 </mrow></math> .</li>
</ol>

<div class="note" id='magicparlabel-226'><div class="note_item"><span class="note_label">Note 18.</span>
The error in <a href="#eq__14">(2.12)</a> comes from the Laplace approximations in <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msup>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>y</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi>z</mi><mo>,</mo>
    <msup>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>, as well as the numerical integration and the choice of locations <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math>. When the likelihood <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo>
    <msup>
     <mrow><mi> &theta; </mi>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>k</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is Gaussian then its marginals are Gaussian and hence this error is eliminated. </div>
</div>
<h3 class="subsection" id='magicparlabel-227'><span class="subsection_label">2.5</span> Byproducts</h3>



<div class="standard" id='magicparlabel-237'><br />

</div>

<div class="note" id='magicparlabel-238'><div class="note_item"><span class="note_label">Note 19.</span>
Marginal likelihood <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is often used in Bayesian model comparison, and model averaging. A natural approximation for the marginal likelihood <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> &int; </mo>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mfrac>
      <mrow>
       <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>z</mi><mo>|</mo><mi>y</mi><mo>,</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow>
          <mover>
           <mrow><mo> Pr </mo>
           </mrow><mo stretchy="true">&Tilde;</mo>
          </mover>
         </mrow>
         <mrow>
          <mstyle mathvariant='normal'><mi>G</mi>
          </mstyle>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>y</mi><mo>|</mo><mi>z</mi><mo>,</mo><mi> &theta; </mi>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi>y</mi><mo>=</mo>
      <msup>
       <mrow><mi>y</mi>
       </mrow>
       <mrow><mo>*</mo>
       </mrow>
      </msup><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </msub>
   <mstyle mathvariant='normal'><mi>d</mi>
   </mstyle><mi> &theta; </mi>
  </mrow>
 </mrow></math>The approx can fail when <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> is multimodal, however LGM generate unimodal posteriors in most cases.</div>
</div>


<div class="note" id='magicparlabel-254'><div class="note_item"><span class="note_label">Note 20.</span>
Deviance Information Criterion (DIC) can be used in Bayesian model comparison. Analogously to AIC, the deviance of the model is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>D</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo>-</mo><mn>2</mn><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi>z</mi><mo>|</mo><mi> &theta; </mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>,</mo>
  </mrow>
 </mrow></math> the model complexity here is measured via effective number of parameters<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>p</mi>
    </mrow>
    <mrow><mi>D</mi>
    </mrow>
   </msub><mo>=</mo>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>D</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>D</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <mstyle mathvariant='normal'><mi>E</mi>
    </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

    <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and hence DIC is defined as<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'>
    <mrow><mi>D</mi><mi>I</mi><mi>C</mi>
    </mrow>
   </mstyle><mo>=</mo>
   <mstyle mathvariant='normal'><mi>E</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>D</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>|</mo><mi>z</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
   <msub>
    <mrow><mi>p</mi>
    </mrow>
    <mrow><mi>D</mi>
    </mrow>
   </msub><mn>.</mn>
  </mrow>
 </mrow></math> Models with smaller DIC are better supported by the data. INLA approximates integrals/expectations numerically after <a href="#eq__8">(2.10)</a> has been approximated. </div>
</div>



<div class="standard" id='magicparlabel-260'><br />

</div>

<div class="note" id='magicparlabel-261'><div class="note_item"><span class="note_label">Note 21.</span>
Predictive distribution of an unseen value <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mstyle mathvariant='normal'>
     <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
     </mrow>
    </mstyle>
   </mrow>
  </msup>
 </mrow></math> (includes missing data) given the observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>z</mi>
 </mrow></math> and model <a href="#eq__4">(2.4)</a> is <a id="eq__11" />
<a id="eq__16" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
         </mrow>
        </mstyle>
       </mrow>
      </msup><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
         </mrow>
        </mstyle>
       </mrow>
      </msup><mo>|</mo>
      <msup>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
         </mrow>
        </mstyle>
       </mrow>
      </msup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
         </mrow>
        </mstyle>
       </mrow>
      </msup><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msup>
      <mrow><mi>y</mi>
      </mrow>
      <mrow>
       <mstyle mathvariant='normal'>
        <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
        </mrow>
       </mstyle>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>(2.14)
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
         </mrow>
        </mstyle>
       </mrow>
      </msup><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msup>
       <mrow><mi>y</mi>
       </mrow>
       <mrow>
        <mstyle mathvariant='normal'>
         <mrow><mi>n</mi><mi>e</mi><mi>w</mi>
         </mrow>
        </mstyle>
       </mrow>
      </msup><mo>|</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi> &theta; </mi><mo>|</mo><mi>z</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle><mi> &theta; </mi>
    </mrow>
   </mtd>
   <mtd>(2.15)
   </mtd>
  </mtr>
 </mtable></math> due to the conditional independence in <a href="#eq__17">(2.1)</a>. Given that <a href="#eq__8">(2.10)</a> has been approximated, INLA employs numerical integration for the integral <a href="#eq__16">(2.15)</a> firstly and <a href="#eq__11">2.15</a> secondly. </div>
</div>
<h2 class="section" id='magicparlabel-262'><span class="section_label">3</span> The R-INLA software (An empirical introduction)</h2>

<div class="note" id='magicparlabel-275'><div class="note_item"><span class="note_label">Note 22.</span>
All the info is int he website of the software <span class="flex_url">https://www.r-inla.org</span> </div>
</div>
<h3 class="subsection" id='magicparlabel-280'><span class="subsection_label">3.1</span> How to install R-INLA</h3>

<div class="standard" id='magicparlabel-281'><br />

</div>

<div class="note" id='magicparlabel-282'><div class="note_item"><span class="note_label">Note 23.</span>
To install R-INLA do the following from <span class="flex_url">https://www.r-inla.org/download-install</span>.</div>
<div class="standard" id='magicparlabel-291'><div class='Frameless'><div class="plain_layout" id='magicparlabel-295'><span style='font-size:small;'># install the stable version, do </span></div>

<div class="plain_layout" id='magicparlabel-296'><span style='font-family:monospace;'><span style='font-size:small;'>install.packages("INLA",repos=c(getOption("repos"),</span></span></div>

<div class="plain_layout" id='magicparlabel-297'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;INLA="https://inla.r-inla-download.org/R/stable"), </span></span></div>

<div class="plain_layout" id='magicparlabel-298'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;dep=TRUE)</span></span></div>

<div class="plain_layout" id='magicparlabel-299'><span style='font-family:monospace;'><span style='font-size:small;'>install.packages("INLA",repos=c(getOption("repos"),</span></span></div>

<div class="plain_layout" id='magicparlabel-300'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;INLA="https://inla.r-inla-download.org/R/testing"),</span></span></div>

<div class="plain_layout" id='magicparlabel-301'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;dep=TRUE)</span></span></div>

<div class="plain_layout" id='magicparlabel-302'><span style='font-size:small;'># update the stable version the package</span></div>

<div class="plain_layout" id='magicparlabel-303'><span style='font-size:small;'>inla.upgrade() </span></div>

<div class="plain_layout" id='magicparlabel-304'><span style='font-size:small;'># install dependency fmesh R package</span></div>

<div class="plain_layout" id='magicparlabel-305'><span style='font-size:small;'>options(repos=c( inlabruorg = "https://inlabru-org.r-universe.dev", </span></div>

<div class="plain_layout" id='magicparlabel-306'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;</span>INLA = "https://inla.r-inla-download.org/R/testing", </span></div>

<div class="plain_layout" id='magicparlabel-307'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;</span>CRAN = "https://cran.rstudio.com")</span></div>

<div class="plain_layout" id='magicparlabel-308'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;</span>) </span></div>

<div class="plain_layout" id='magicparlabel-309'><span style='font-size:small;'>install.packages("fmesher")</span></div>
</div></div>
</div>
<h3 class="subsection" id='magicparlabel-310'><span class="subsection_label">3.2</span> How to use R-INLA</h3>

<div class="note" id='magicparlabel-311'><div class="note_item"><span class="note_label">Note 24.</span>
There are two essential steps: </div>

<ol class="enumerate" id='magicparlabel-312'><li class="enumerate_item">Define the linear predictor <a href="#eq__20">(2.6)</a> through a formula object </li>
<li class="enumerate_item">Complete the model definition and fit the model using the R function <span style='font-family:monospace;'>inla{INLA}</span>.</li>
</ol>
<div class="standard" id='magicparlabel-314'>The fitted model is returned as an inla object. </div>
</div>

<div class="standard" id='magicparlabel-320'><br />

</div>

<div class="example" id='magicparlabel-321'><div class="example_item"><span class="example_label">Example 25.</span>
We analyze the R dataset <span style='font-family:monospace;'>Salm{INLA}</span>.</div>

<ul class="itemize" id='magicparlabel-322'><li class="itemize_item">Bayesian model<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>
  <mtable>
   <mtr>
    <mtd>
     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub><mo> &sim; </mo>
      <mstyle mathvariant='normal'>
       <mrow><mi>P</mi><mi>o</mi><mi>i</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mtd>
    <mtd>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mn>6</mn><mspace width="6px" /><mspace width="6px" />
      <mstyle mathvariant='normal'>
       <mrow><mi>a</mi><mi>n</mi><mi>d</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mspace width="6px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn>
     </mrow>
    </mtd>
   </mtr>
   <mtr>
    <mtd>
     <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mn>0</mn>
       </mrow>
      </msub><mo>+</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>x</mi>
        </mrow>
        <mrow><mi>i</mi>
        </mrow>
       </msub><mo>+</mo><mn>10</mn>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
      <msub>
       <mrow><mi> &beta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msub>
      <msub>
       <mrow><mi>x</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>+</mo>
      <msub>
       <mrow><mi>u</mi>
       </mrow>
       <mrow>
        <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
        </mrow>
       </mrow>
      </msub>
     </mrow>
    </mtd>
    <mtd>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>...</mn><mo>,</mo><mn>6</mn><mspace width="6px" /><mspace width="6px" />
      <mstyle mathvariant='normal'>
       <mrow><mi>a</mi><mi>n</mi><mi>d</mi>
       </mrow>
      </mstyle><mspace width="6px" /><mspace width="6px" /><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn>
     </mrow>
    </mtd>
   </mtr>
  </mtable>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> (the observables) are number of colonies found on plate <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>j</mi>
 </mrow></math> for dose <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>x</mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
 </mrow></math> indicate the <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>i</mi>
 </mrow></math>th dose. Let <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>u</mi>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mi>j</mi>
     </mrow>
    </mrow>
   </msub><mo>|</mo><mi> &tau; </mi><mo> &sim; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mn>0</mn><mo>,</mo>
    <msup>
     <mrow><mi> &sigma; </mi>
     </mrow>
     <mrow><mn>2</mn>
     </mrow>
    </msup>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> be the so-called random effects, while <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &beta; </mi>
   </mrow>
   <mrow><mi>i</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> are unknown parameters called fixed effects. </li>
<li class="itemize_item">In terms of model <a href="#eq__4">(2.4)</a>, the GMRF is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>y</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msub>
     <mrow><mi> &lambda; </mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
      </mrow>
     </mrow>
    </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msub>
     <mrow><mi> &beta; </mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>
<mo>,</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msub>
     <mrow><mi>u</mi>
     </mrow>
     <mrow>
      <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
      </mrow>
     </mrow>
    </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </li>
<li class="itemize_item">We consider prior on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> &sigma; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msup>
 </mrow></math> such that <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>=</mo><mo>-</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo>-</mo><mn>2</mn>&nbsp;<mi>G</mi><mi>i</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>/</mo><mn>2</mn><mo>,</mo><mo>-</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>/</mo><mi>u</mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mstyle>
  </mrow>
 </mrow></math>This is because R-INLA specifies prior on <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &tau; </mi><mo>=</mo><mo>-</mo><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> . </li>
</ul>
</div>
<h5 class="paragraph_" id='magicparlabel-325'>Data loading</h5>

<ul class="itemize" id='magicparlabel-326'><li class="itemize_item">Load R-INLA
<div class="standard" id='magicparlabel-327'><div class='Frameless'><div class="plain_layout" id='magicparlabel-331'><span style='font-family:monospace;'><span style='font-size:small;'># load the data set</span></span></div>

<div class="plain_layout" id='magicparlabel-332'><span style='font-family:monospace;'><span style='font-size:small;'>library(&ldquo;INLA&rdquo;)</span></span></div>
</div></div>
</li><li class="itemize_item">We import the R data set <span style='font-family:monospace;'>Salm{INLA}</span> as follows 
<div class="standard" id='magicparlabel-338'><div class='Frameless'><div class="plain_layout" id='magicparlabel-342'><span style='font-family:monospace;'><span style='font-size:small;'># load the data set </span></span></div>

<div class="plain_layout" id='magicparlabel-343'><span style='font-family:monospace;'><span style='font-size:small;'>data(Salm) </span></span></div>

<div class="plain_layout" id='magicparlabel-344'># get info about the R dataset</div>

<div class="plain_layout" id='magicparlabel-345'>?Salm</div>

<div class="plain_layout" id='magicparlabel-346'><span style='font-family:monospace;'><span style='font-size:small;'># rename the columns to fit the notation </span></span></div>

<div class="plain_layout" id='magicparlabel-347'><span style='font-family:monospace;'><span style='font-size:small;'>names(Salm) = c("z", "x", "u") </span></span></div>
</div></div>
</li></ul>
<h5 class="paragraph_" id='magicparlabel-348'>Training via R-INLA</h5>

<ul class="itemize" id='magicparlabel-349'><li class="itemize_item">Code the model in R-INLA language, and produce the inla object 
<div class="standard" id='magicparlabel-350'><div class='Frameless'><div class="plain_layout" id='magicparlabel-354'><span style='font-family:monospace;'><span style='font-size:small;'># specify the prior for the log precision parameter</span></span></div>

<div class="plain_layout" id='magicparlabel-355'><span style='font-family:monospace;'><span style='font-size:small;'>my.hyper &lt;- list(theta = list(prior="pc.prec", param=c(1,0.01)))</span></span></div>

<div class="plain_layout" id='magicparlabel-356'><span style='font-family:monospace;'><span style='font-size:small;'># specify the linear predictor</span></span></div>

<div class="plain_layout" id='magicparlabel-357'><span style='font-family:monospace;'><span style='font-size:small;'>formula &lt;- z ~ log(x + 10) + x + f(u, model = "iid", hyper = my.hyper)</span></span></div>

<div class="plain_layout" id='magicparlabel-358'><span style='font-family:monospace;'><span style='font-size:small;'># run R-INLA and get the result object</span></span></div>

<div class="plain_layout" id='magicparlabel-359'><span style='font-family:monospace;'><span style='font-size:small;'>result &lt;- inla(formula=formula, data=Salm, family="Poisson",</span></span></div>

<div class="plain_layout" id='magicparlabel-360'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;control.inla = list(strategy=&rdquo;</span></span>laplace<span style='font-family:monospace;'><span style='font-size:small;'>&rdquo;))</span></span></div>
</div></div>
</li><li class="itemize_item">The `<span style='font-family:monospace;'>formula</span>' is as in <span style='font-family:monospace;'>lm{stats}</span> command. </li>
<li class="itemize_item">Function `<span style='font-family:monospace;'>inla.list.models()</span>' provides a list of available distributions for the different parts of the model, such as the "prior" (available priors for the hyper-parameters), "likelihood" (all implemented likelihoods) and "latent" (available models for the latent field).</li>
<li class="itemize_item">Function <span style='font-family:monospace;'>f()</span> is used to specify the latent Gaussian model for the non-linear terms and random effect <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>u</mi>
   </mrow>
   <mrow>
    <mrow><mi>i</mi><mi>j</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math>; here an independent noise model (hence the use of model = "iid"), and the hyperprior for its corresponding hyperparameters (here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> &sigma; </mi>
   </mrow>
   <mrow><mn>2</mn>
   </mrow>
  </msup>
 </mrow></math>). </li>
<li class="itemize_item">R function <span style='font-family:monospace;'>inla{INLA}</span> (given the input above) generates an inla object similar to that of <span style='font-family:monospace;'>lm{stats}</span>. The data object should be data.frame or list. The likelihood is specified in form of a string.  <span style='font-family:monospace;'><span style='font-size:small;'>strategy=&rdquo;</span></span>laplace<span style='font-family:monospace;'><span style='font-size:small;'>&rdquo;</span></span> refers to the approximation strategy in Note <a href="#note_To_compute_an">16</a> and has options &ldquo;gaussian&rdquo;, &ldquo;simplified.laplace&rdquo;, &ldquo;laplace&rdquo;.</li>
</ul>
<h5 class="paragraph_" id='magicparlabel-381'>Parametric inference </h5>

<ul class="itemize" id='magicparlabel-382'><li class="itemize_item">Post-processing the results from <span style='font-family:monospace;'><span style='font-size:small;'>inla</span></span> object. 
<div class="standard" id='magicparlabel-383'><div class='Frameless'><div class="plain_layout" id='magicparlabel-387'><span style='font-family:monospace;'><span style='font-size:small;'>summary(result)</span></span></div>

<div class="plain_layout" id='magicparlabel-388'><img style='width:90%;' src='0_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_1.png' alt='image: 0_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_1.png' />
</div>
</div> </div>

<div class="standard" id='magicparlabel-389'>It provides summary statistics of the posterior of the fixed effect, random effect, and precision parameters, as well as the marginal log-likelihood <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>z</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>
</li><li class="itemize_item">Marginal posteriors for the fixed effect, random effect, and hyperparameters are stored in <span style='font-family:monospace;'>result$marginals.fixed</span>, <span style='font-family:monospace;'>result$marginals.random</span>, <span style='font-family:monospace;'>result$marginals.hyperpar</span>. E.g., one can plot the posterior of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &beta; </mi>
   </mrow>
   <mrow><mn>1</mn>
   </mrow>
  </msub>
 </mrow></math> as 
<div class="standard" id='magicparlabel-391'><div class='Frameless'><div class="plain_layout" id='magicparlabel-395'><span style='font-family:monospace;'><span style='font-size:small;'>beta_1_pdf &lt;- result$marginals.fixed$`log(x + 10)` </span></span></div>

<div class="plain_layout" id='magicparlabel-396'><span style='font-family:monospace;'><span style='font-size:small;'>plot(beta_1_pdf[,1], beta_1_pdf[,2], type="l")</span></span></div>

<div class="plain_layout" id='magicparlabel-397'><img style='width:40%;' src='1_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____ics_IV_Handouts_figures_beta_1_inla_example.png' alt='image: 1_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____ics_IV_Handouts_figures_beta_1_inla_example.png' />
</div>
</div></div>
</li><li class="itemize_item">Summary of the above marginal posteriors can be obtained by using <span style='font-family:monospace;'>result$summary.fixed</span>, <span style='font-family:monospace;'>result$summary.random</span>, <span style='font-family:monospace;'>result$summary.hyperpar </span>
<div class="standard" id='magicparlabel-399'><div class='Frameless'><div class="plain_layout" id='magicparlabel-403'>result$marginals.fixed</div>

<div class="plain_layout" id='magicparlabel-404'><img style='width:90%;' src='2_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_2.png' alt='image: 2_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_2.png' />
</div>

<div class="plain_layout" id='magicparlabel-405'>result$summary.hyperpar</div>

<div class="plain_layout" id='magicparlabel-406'><img style='width:90%;' src='3_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_3.png' alt='image: 3_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_3.png' />
</div>
</div></div>
</li><li class="itemize_item">To get the posterior summary of a function of the parameters, e.g. the posterior mean and standard deviation of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo>=</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &tau; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>
<div class="standard" id='magicparlabel-408'><div class='Frameless'><div class="plain_layout" id='magicparlabel-412'># Select the right hyperparameter marginal </div>

<div class="plain_layout" id='magicparlabel-413'>tau &lt;- result$marginals.hyperpar[[1]] </div>

<div class="plain_layout" id='magicparlabel-414'># Compute the expected value for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>1</mn><mo>/</mo>
   <msqrt><mi> &tau; </mi>
   </msqrt>
  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mn>1</mn><mo>/</mo>
   <msup>
    <mrow>
     <msqrt><mi> &tau; </mi>
     </msqrt>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> </div>

<div class="plain_layout" id='magicparlabel-415'>E = inla.emarginal(function(x) c(1/sqrt(x),(1/sqrt(x))^2), tau) </div>

<div class="plain_layout" id='magicparlabel-416'># From this we computed the posterior standard deviation as </div>

<div class="plain_layout" id='magicparlabel-417'>mysd = sqrt(E[2] - E[1]^2) </div>

<div class="plain_layout" id='magicparlabel-418'># so that we obtain the posterior mean and standard deviation </div>

<div class="plain_layout" id='magicparlabel-419'>print(c(mean=E[1], sd=mysd))</div>

<div class="plain_layout" id='magicparlabel-420'><img src='4_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_4.png' alt='image: 4_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____s_IV_Handouts_figures_inla_example_output_4.png' />
</div>
</div></div>
</li><li class="itemize_item">To compute the marginal posterior distribution of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &sigma; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msup><mo>=</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &tau; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> use the <span style='font-family:monospace;'>inla.tmarginal() </span>
<div class="standard" id='magicparlabel-422'><div class='Frameless'><div class="plain_layout" id='magicparlabel-426'># Select the right hyperparameter marginal </div>

<div class="plain_layout" id='magicparlabel-427'>tau &lt;- result$marginals.hyperpar[[1]] </div>

<div class="plain_layout" id='magicparlabel-428'># Do the transformation</div>

<div class="plain_layout" id='magicparlabel-429'>my.sigma &lt;- inla.tmarginal(function(x){1/sqrt(x)}, tau)</div>

<div class="plain_layout" id='magicparlabel-430'># plot</div>

<div class="plain_layout" id='magicparlabel-431'>plot(my.sigma[,1], my.sigma[,2], type="l")</div>

<div class="plain_layout" id='magicparlabel-432'><img style='width:45%;' src='5_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____stics_IV_Handouts_figures_sig2_inla_example.png' alt='image: 5_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____stics_IV_Handouts_figures_sig2_inla_example.png' />
</div>
</div></div>
</li><li class="itemize_item">Other R-INLA functions providing operations on posterior marginals can be found in R help documentation, 
<div class="standard" id='magicparlabel-434'><div class='Frameless'><div class="plain_layout" id='magicparlabel-438'>?inla.marginal</div>
</div></div>
</li></ul>
<h5 class="paragraph_" id='magicparlabel-439'>Predictive inference</h5>

<ul class="itemize" id='magicparlabel-440'><li class="itemize_item">In R-INLA there is no function <span style='font-family:monospace;'>predict{stats}</span> as for <span style='font-family:monospace;'>glm{stats}</span> or <span style='font-family:monospace;'>lm{stats}</span>. Predictions must be done as a part of the model fitting itself. Prediction can be regarded as fitting a model with missing data, hence we can simply set <span style='font-family:monospace;'>y[i]=NA</span> for those âlocationsâ we want to predict. Predictive distributions, which are often of interest, are however not returned directly, and the user needs to some extra &ldquo;hacks&rdquo;. There are two reasonable &ldquo;hacks&rdquo;.</li>
<li class="itemize_item">For illustration, pretend <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mn>7</mn>
 </mrow></math>th observation is unknown, by removing it from the training data, and try to predict it.
<div class="standard" id='magicparlabel-442'><div class='Frameless'><div class="plain_layout" id='magicparlabel-446'><span style='font-family:monospace;'><span style='font-size:small;'>## set observation 7 to NA </span></span></div>

<div class="plain_layout" id='magicparlabel-447'><span style='font-family:monospace;'><span style='font-size:small;'>Salm.predict = Salm </span></span></div>

<div class="plain_layout" id='magicparlabel-448'><span style='font-family:monospace;'><span style='font-size:small;'>Salm.predict[7, "y"] &lt;- NA </span></span></div>

<div class="plain_layout" id='magicparlabel-449'><span style='font-family:monospace;'><span style='font-size:small;'># re-run the model </span></span></div>

<div class="plain_layout" id='magicparlabel-450'><span style='font-family:monospace;'><span style='font-size:small;'>res.predict = inla(formula=formula, data=Salm, &emsp;&emsp;family="Poisson", </span></span></div>

<div class="plain_layout" id='magicparlabel-451'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;control.predictor = list(compute = TRUE), </span></span></div>

<div class="plain_layout" id='magicparlabel-452'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;control.family = list(control.link=list(model="log")) )</span></span></div>
</div></div>
</li><li class="itemize_item">Using the same settings as before, train the model by function <span style='font-family:monospace;'>inla(INLA)</span>. 
<div class="standard" id='magicparlabel-454'><div class='Frameless'><div class="plain_layout" id='magicparlabel-458'><span style='font-family:monospace;'><span style='font-size:small;'># re-run the model</span></span></div>

<div class="plain_layout" id='magicparlabel-459'><span style='font-family:monospace;'><span style='font-size:small;'>res.predict = inla(formula=formula, data=Salm, &emsp;&emsp;family="Poisson",</span></span></div>

<div class="plain_layout" id='magicparlabel-460'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;control.predictor = list(compute = TRUE),</span></span></div>

<div class="plain_layout" id='magicparlabel-461'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;control.compute=list(return.marginals.predictor=TRUE),</span></span></div>

<div class="plain_layout" id='magicparlabel-462'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;control.family = list(control.link=list(model="log")) )</span></span></div>
</div></div>

<div class="standard" id='magicparlabel-463'>By specifying <span style='font-family:monospace;'>control.predictor=list(compute=TRUE)</span> the posterior marginals will be included in the results object. We also need to explicitly specify the link function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>g</mi>
 </mrow></math> connecting <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>g</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &lambda; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &lambda; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>=</mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>E</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi>z</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mstyle>
  </mrow>
 </mrow></math>, using the <span style='font-family:monospace;'>control.family</span> object in order for <span style='font-family:monospace;'>inla() </span>to compute the linear predictor <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mn>.</mn>
  </mrow>
 </mrow></math> Note that here <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &lambda; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>=</mo><mo> exp </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. By specifying <span style='font-family:monospace;'><span style='font-size:small;'>control.compute=list(return.marginals.predictor=TRUE)</span></span>, we ask function <span style='font-family:monospace;'>inla(INLA)</span> to compute and return the marginal pdf of the linear predictor, which be default are not due to computational cost. </div>
</li><li class="itemize_item">We can compute <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &eta; </mi>
     </mrow>
     <mrow><mn>7</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>7</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> by
<div class="standard" id='magicparlabel-465'><div class='Frameless'><div class="plain_layout" id='magicparlabel-469'><span style='font-family:monospace;'><span style='font-size:small;'># marginal posterior for the linear predictor</span></span></div>

<div class="plain_layout" id='magicparlabel-470'><span style='font-family:monospace;'><span style='font-size:small;'>eta7 = res.predict$marginals.linear.predictor[[7]]</span></span></div>

<div class="plain_layout" id='magicparlabel-471'><span style='font-size:small;'><img style='width:49%;' src='6_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____ndouts_figures_pred_distr_eta7_inla_example.png' alt='image: 6_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____ndouts_figures_pred_distr_eta7_inla_example.png' />
</span></div>
</div></div>
</li><li class="itemize_item">Summary about is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &eta; </mi>
     </mrow>
     <mrow><mn>7</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>7</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> taken by 
<div class="standard" id='magicparlabel-473'><div class='Frameless'><div class="plain_layout" id='magicparlabel-477'><span style='font-family:monospace;'><span style='font-size:small;'># some summary statistics round(res.predict$summary.linear.predictor[7,], 3)</span></span></div>

<div class="plain_layout" id='magicparlabel-478'><span style='font-size:small;'><img style='width:100%;' src='7_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____uts_R_scripts_figures_inla_example_output_5.png' alt='image: 7_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____uts_R_scripts_figures_inla_example_output_5.png' />
</span></div>
</div></div>
</li><li class="itemize_item">We can compute <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &lambda; </mi>
     </mrow>
     <mrow><mn>7</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>7</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> by
<div class="standard" id='magicparlabel-480'><div class='Frameless'><div class="plain_layout" id='magicparlabel-484'><span style='font-family:monospace;'><span style='font-size:small;'># marginal posterior for lambda </span></span></div>

<div class="plain_layout" id='magicparlabel-485'><span style='font-size:small;'>eta7 = res.predict$marginals.linear.predictor[[7]]</span></div>

<div class="plain_layout" id='magicparlabel-486'><span style='font-family:monospace;'><span style='font-size:small;'>lambda7 = inla.tmarginal(function(x){exp(x)}, eta7)</span></span></div>

<div class="plain_layout" id='magicparlabel-487'><span style='font-size:small;'>## or alternatively</span></div>

<div class="plain_layout" id='magicparlabel-488'><span style='font-size:small;'># lambda7_bis = inla.tmarginal(function(x){exp(x)},eta7)</span></div>

<div class="plain_layout" id='magicparlabel-489'><span style='font-size:small;'>## or alternatively</span></div>

<div class="plain_layout" id='magicparlabel-490'><span style='font-size:small;'># lambda7_bis = inla.tmarginal(function(x){exp(x)},eta7)</span></div>

<div class="plain_layout" id='magicparlabel-491'><span style='font-family:monospace;'><span style='font-size:small;'># plot</span></span></div>

<div class="plain_layout" id='magicparlabel-492'><span style='font-family:monospace;'><span style='font-size:small;'>plot(lambda7[,1], lambda7[,2], type="l")</span></span></div>

<div class="plain_layout" id='magicparlabel-493'><span style='font-size:small;'><img style='width:49%;' src='8_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____uts_figures_pred_distr_lambda7_inla_example.png' alt='image: 8_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____uts_figures_pred_distr_lambda7_inla_example.png' />
</span></div>
</div></div>
</li><li class="itemize_item">To compute <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow><mn>7</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>7</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> i.e. the predictive distribution (in this case) or the posterior distribution of the missing value (in principle), we can consider the following integration<a id="eq_" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>7</mn>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo> &int; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>7</mn>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &lambda; </mi>
      </mrow>
      <mrow><mn>7</mn>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>(3.1)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo> &ap; </mo><mo> &int; </mo>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>7</mn>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
     <msub>
      <mrow><mi> &lambda; </mi>
      </mrow>
      <mrow><mn>7</mn>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
 </mtable></math> and either approximated by using numerical integration, e.g. trapezoid rule with R function <span style='font-family:monospace;'>trapz{caTools}</span> 
<div class="standard" id='magicparlabel-495'><div class='Frameless'><div class="plain_layout" id='magicparlabel-499'><span style='font-family:monospace;'><span style='font-size:small;'># library supporting trapezoid rule integration. </span></span></div>

<div class="plain_layout" id='magicparlabel-500'><span style='font-family:monospace;'><span style='font-size:small;'>library(caTools) </span></span></div>

<div class="plain_layout" id='magicparlabel-501'><span style='font-family:monospace;'><span style='font-size:small;'># specify the support at which we want to compute the density </span></span></div>

<div class="plain_layout" id='magicparlabel-502'><span style='font-family:monospace;'><span style='font-size:small;'>z_tick_vec = 0:100 </span></span></div>

<div class="plain_layout" id='magicparlabel-503'><span style='font-family:monospace;'><span style='font-size:small;'>z7_pdf = rep(0,101) </span></span></div>

<div class="plain_layout" id='magicparlabel-504'><span style='font-family:monospace;'><span style='font-size:small;'># go over the posterior marginal of the fitted value </span></span></div>

<div class="plain_layout" id='magicparlabel-505'><span style='font-family:monospace;'><span style='font-size:small;'>for(j in 1:(length(lambda7[ ,1])-1)) { </span></span></div>

<div class="plain_layout" id='magicparlabel-506'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;z7_pdf &lt;- z7_pdf + dpois(z_tick_vec, </span></span></div>

<div class="plain_layout" id='magicparlabel-507'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;&emsp;&emsp;lambda = ((lambda7[j,1]+ lambda7[j+1,1])/2)) </span></span></div>

<div class="plain_layout" id='magicparlabel-508'><span style='font-family:monospace;'><span style='font-size:small;'>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;* trapz(lambda7[j:(j+1), 1], lambda7[j:(j+1), 2]) </span></span></div>

<div class="plain_layout" id='magicparlabel-509'><span style='font-family:monospace;'><span style='font-size:small;'>} </span></span></div>

<div class="plain_layout" id='magicparlabel-510'><span style='font-family:monospace;'><span style='font-size:small;'># plot</span></span></div>

<div class="plain_layout" id='magicparlabel-511'><span style='font-family:monospace;'><span style='font-size:small;'>plot(z_tick_vec,z7_pdf, type="l")</span></span></div>

<div class="plain_layout" id='magicparlabel-512'><span style='font-size:small;'><img style='width:49%;' src='9_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____Handouts_figures_pred_distr_z7_inla_example.png' alt='image: 9_extra_tmp_mffk55_Dropbox_Teaching_2023_term1____Handouts_figures_pred_distr_z7_inla_example.png' />
</span></div>
</div></div>
</li><li class="itemize_item">alternatively one approximate <a href="#eq_">(3.1)</a> by Monte Carlo integration <a id="eq__3" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow>
        <mrow><mo>-</mo><mn>7</mn>
        </mrow>
       </mrow>
      </msub>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo> &ap; </mo>
     <msub>
      <mrow>
       <mstyle mathvariant='normal'><mi>E</mi>
       </mstyle>
      </mrow>
      <mrow>
       <mrow>
        <mover>
         <mrow><mo> Pr </mo>
         </mrow><mo stretchy="true">&Tilde;</mo>
        </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi> &lambda; </mi>
          </mrow>
          <mrow><mn>7</mn>
          </mrow>
         </msub><mo>|</mo>
         <msub>
          <mrow><mi>z</mi>
          </mrow>
          <mrow>
           <mrow><mo>-</mo><mn>7</mn>
           </mrow>
          </mrow>
         </msub>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <mover>
       <mrow><mo> Pr </mo>
       </mrow><mo stretchy="true">&Tilde;</mo>
      </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msub>
        <mrow><mi>z</mi>
        </mrow>
        <mrow><mn>7</mn>
        </mrow>
       </msub><mo>|</mo>
       <msub>
        <mrow><mi> &lambda; </mi>
        </mrow>
        <mrow><mn>7</mn>
        </mrow>
       </msub>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(3.2)
   </mtd>
  </mtr>
  <mtr>
   <mtd><mrow/>
   </mtd>
   <mtd>
    <mrow><mo> &ap; </mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>T</mi>
      </mrow>
     </msubsup>
     <mover>
      <mrow><mo> Pr </mo>
      </mrow><mo stretchy="true">&Tilde;</mo>
     </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>z</mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
      </msub><mo>|</mo>
      <msubsup>
       <mrow><mi> &lambda; </mi>
       </mrow>
       <mrow><mn>7</mn>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msubsup>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
   </mtd>
  </mtr>
 </mtable></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msubsup>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

    <msubsup>
     <mrow><mi> &lambda; </mi>
     </mrow>
     <mrow><mn>7</mn>
     </mrow>
     <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </msubsup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

   </mrow>
   <mrow>
    <mrow><mi>t</mi><mo>=</mo><mn>1</mn>
    </mrow>
   </mrow>
   <mrow><mi>T</mi>
   </mrow>
  </msubsup>
 </mrow></math> is a sample drawn from <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mover>
    <mrow><mo> Pr </mo>
    </mrow><mo stretchy="true">&Tilde;</mo>
   </mover><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &lambda; </mi>
     </mrow>
     <mrow><mn>7</mn>
     </mrow>
    </msub><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mo>-</mo><mn>7</mn>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> by using function inla.rmarginal{INLA} as follows.
<div class="standard" id='magicparlabel-514'><div class='Frameless'><div class="plain_layout" id='magicparlabel-518'><span style='font-size:small;'># set the number of samples (T)</span></div>

<div class="plain_layout" id='magicparlabel-519'><span style='font-family:monospace;'><span style='font-size:small;'>n.samples = 3000 </span></span></div>

<div class="plain_layout" id='magicparlabel-520'><span style='font-family:monospace;'><span style='font-size:small;'># sample from the marginal latent distribution</span></span></div>

<div class="plain_layout" id='magicparlabel-521'><span style='font-family:monospace;'><span style='font-size:small;'>samples_lambda = inla.rmarginal(n.samples, lambda7) </span></span></div>

<div class="plain_layout" id='magicparlabel-522'><span style='font-family:monospace;'><span style='font-size:small;'># sample from the likelihood model </span></span></div>

<div class="plain_layout" id='magicparlabel-523'><span style='font-family:monospace;'><span style='font-size:small;'>predDist = rpois(n.samples, lambda = samples_lambda)</span></span></div>

<div class="plain_layout" id='magicparlabel-524'><span style='font-size:small;'><img style='width:49%;' src='10_extra_tmp_mffk55_Dropbox_Teaching_2023_term1___douts_figures_pred_distr_z7_MC_inla_example.png' alt='image: 10_extra_tmp_mffk55_Dropbox_Teaching_2023_term1___douts_figures_pred_distr_z7_MC_inla_example.png' />
</span></div>
</div></div>
</li></ul>
<div class="standard" id='magicparlabel-525'><br />
</div>
<h2 class="section" id='magicparlabel-526'><span class="section_label">A</span> Optimization algorithms<div class="marginal"><div class="plain_layout" id='magicparlabel-530'>Introduced 
<br />

in 
<br />

ASM3,
<br />

MLNN3</div>
</div></h2>

<div class="note" id='magicparlabel-531'><div class="note_item"><span class="note_label">Note 26.</span>
Assume we wish to address the minimization problem <a id="eq__18" />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mover>
      <mrow><mi> &theta; </mi>
      </mrow><mo stretchy="true">&circ;</mo>
     </mover><mo>=</mo><munder accent='false'>
     <mrow><mo> arg </mo><mo> min </mo>
     </mrow><mi> &theta; </mi></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>(A.1)
   </mtd>
  </mtr>
 </mtable></math> for some cost function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mo> &sdot; </mo>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </div>
</div>

<div class="standard" id='magicparlabel-532'><br />

</div>

<div class="note" id='magicparlabel-533'><div class="note_item"><span class="note_label">Note 27.</span>
For instance, Proposition <a href="#note_Assume___Consider">1</a>, it is <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo>-</mo><mn>2</mn><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>L</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>
</div>

<div class="standard" id='magicparlabel-534'><br />

</div>

<div class="note" id='magicparlabel-535'><div class="note_item"><span class="note_label">Note 28.</span>
 Newton algorithm and Gradient descent algorithms are two optimization algorithms aiming to address the minimization problem <a href="#eq__18">(A.1)</a>. Each of them generate a convergence sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> to <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mover>
   <mrow><mi> &theta; </mi>
   </mrow><mo stretchy="true">&circ;</mo>
  </mover>
 </mrow></math> as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo> &rarr; </mo>
   <mover>
    <mrow><mi> &theta; </mi>
    </mrow><mo stretchy="true">&circ;</mo>
   </mover>
  </mrow>
 </mrow></math> under regularity conditions (omitted here). </div>
</div>

<div class="standard" id='magicparlabel-540'><br />

</div>

<div class="algorithm" id='magicparlabel-541'><div class="algorithm_item"><span class="algorithm_label">Algorithm 29.</span>
Newton algorithm consist of the recursion <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>-</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mrow>
        <msubsup>
         <mrow><mi> &nabla; </mi>
         </mrow>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi> &theta; </mi><mo>=</mo>
        <msup>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

         </mrow>
        </msup>
       </mrow>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo>
      <msup>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
     </msub><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

   </mrow>
   <mrow>
    <mrow><mi> &theta; </mi><mo>=</mo>
     <msup>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the gradient of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

    <mrow>
     <msubsup>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

   </mrow>
   <mrow>
    <mrow><mi> &theta; </mi><mo>=</mo>
     <msup>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the Hessian matrix of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math>. It requires a user specified seed <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math>. The recursion stops when a termination criterion such as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &ge; </mo>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow><mo> max </mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>, for some user specified <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow><mo> max </mo>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, is satisfied.</div>
</div>

<div class="standard" id='magicparlabel-542'><br />

</div>

<div class="algorithm" id='magicparlabel-543'><div class="algorithm_item"><span class="algorithm_label">Algorithm 30.</span>
Gradient descent algorithm consist of the recursion <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>=</mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup><mo>-</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo>
      <msup>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
     </msub><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

   </mrow>
   <mrow>
    <mrow><mi> &theta; </mi><mo>=</mo>
     <msup>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </msup>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> is the gradient of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> at <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </msup>
  </mrow>
 </mrow></math>. It requires a user specified positive non-increasing sequence <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>{</mo>

  <msub>
   <mrow><mi> &eta; </mi>
   </mrow>
   <mrow><mi>t</mi>
   </mrow>
  </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>}</mo>

 </mrow></math> such as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <msqrt>
    <mrow><mn>1</mn><mo>/</mo><mi>t</mi>
    </mrow>
   </msqrt>
  </mrow>
 </mrow></math>, and a user specified seed <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msup>
   <mrow><mi> &theta; </mi>
   </mrow>
   <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mn>0</mn>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
  </msup>
 </mrow></math> . The recursion stops when a termination criterion such as <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>t</mi><mo> &ge; </mo>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow><mo> max </mo>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> for some user-specified <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>T</mi>
    </mrow>
    <mrow><mo> max </mo>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, is satisfied.</div>
</div>

<div class="standard" id='magicparlabel-544'><br />

</div>

<div class="example" id='magicparlabel-545'><div class="example_item"><span class="example_label">Example 31.</span>
Consider the marginal likelihood<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>x</mi><mo>|</mo><mi>a</mi><mo>,</mo><mi>b</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <mrow><mo> &Gamma; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <msup>
         <mrow><mi>b</mi>
         </mrow>
         <mrow><mi>a</mi>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mfrac>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msup>
   <msubsup>
    <mrow><mo> &prod; </mo>
    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
     </mrow>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msubsup>
   <msubsup>
    <mrow><mi>x</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
    <mrow><mi>a</mi>
    </mrow>
   </msubsup>
   <msup>
    <mrow><mi>e</mi>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mi>n</mi>
      <mover>
       <mrow><mi>x</mi>
       </mrow><mo stretchy="true">&OverBar;</mo>
      </mover>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi>b</mi>
       </mrow>
      </mfrac>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>b</mi><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math>. Write the Newton alg., and Gradient descent alg. recursions for to find <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mo>*</mo>
    </mrow>
   </msup><mo>=</mo><munder accent='false'>
   <mrow><mo> arg </mo><mo> min </mo>
   </mrow><mi> &theta; </mi></munder><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mo>-</mo>
    <msub>
     <mrow><mi> &ell; </mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &ell; </mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo> log </mo><mi>f</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>x</mi><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi>a</mi><mo>,</mo><mi>b</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>. </div>

<dl class='description' id='magicparlabel-546'><dt class="description_label">Hint-1</dt>
<dd class="description_item"> Digamma function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &psi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <mstyle mathvariant='normal'><mi>d</mi>
     </mstyle>
    </mrow>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle><mi>x</mi>
     </mrow>
    </mrow>
   </mfrac><mo> log </mo><mo> &Gamma; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></dd>
<dt class="description_label">Hint-2</dt>
<dd class="description_item"> Trigamma function <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &psi; </mi>
    </mrow>
    <mrow><mn>1</mn>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
   <mfrac>
    <mrow>
     <msup>
      <mrow>
       <mstyle mathvariant='normal'><mi>d</mi>
       </mstyle>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msup>
    </mrow>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'><mi>d</mi>
      </mstyle>
      <msup>
       <mrow><mi>x</mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mfrac><mo> log </mo><mo> &Gamma; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>x</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math></dd>
<dt class="description_label">Hint-3</dt>
<dd class="description_item"> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
     <mtable>
      <mtr>
       <mtd><mi>a</mi>
       </mtd>
       <mtd><mi>b</mi>
       </mtd>
      </mtr>
      <mtr>
       <mtd><mi>c</mi>
       </mtd>
       <mtd><mi>d</mi>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo>
    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>d</mi><mi>e</mi><mi>t</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>A</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd><mi>d</mi>
     </mtd>
     <mtd>
      <mrow><mo>-</mo><mi>b</mi>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mo>-</mo><mi>c</mi>
      </mrow>
     </mtd>
     <mtd><mi>a</mi>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>=</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <mrow>
      <mstyle mathvariant='normal'>
       <mrow><mi>d</mi><mi>e</mi><mi>t</mi>
       </mrow>
      </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>A</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd><mi>d</mi>
     </mtd>
     <mtd>
      <mrow><mo>-</mo><mi>b</mi>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mo>-</mo><mi>c</mi>
      </mrow>
     </mtd>
     <mtd><mi>a</mi>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo>
  </mrow>
 </mrow></math></dd>
</dl>

<div class="proof" id='magicparlabel-549'><div class="proof_item"><span class="proof_label">Proof.</span>
Gradient descent's recursion is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>+</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub>
      <msub>
       <mrow><mi> &ell; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msup>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup><mo>,</mo>
       <msup>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub><mo>=</mo>
   <msqrt>
    <mrow><mn>1</mn><mo>/</mo><mi>t</mi>
    </mrow>
   </msqrt>
  </mrow>
 </mrow></math>, where <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &ell; </mi>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo>-</mo><mi>n</mi><mo> log </mo><mo> &Gamma; </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>n</mi><mi>a</mi><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>b</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>b</mi>
      </mrow>
     </mfrac>
     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi>x</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub><mo>+</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mi>a</mi><mo>-</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     <msubsup>
      <mrow><mo> &sum; </mo>
      </mrow>
      <mrow>
       <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msubsup><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <msub>
      <mrow><mi>x</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
     </msub>
     <msub>
      <mrow><mi> &ell; </mi>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo>
    </mrow>
   </mtd>
   <mtd>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow><mo>-</mo><mi>n</mi><mi> &psi; </mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>-</mo><mi>n</mi><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>b</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo>
         <msubsup>
          <mrow><mo> &sum; </mo>
          </mrow>
          <mrow>
           <mrow><mi>i</mi><mo>=</mo><mn>1</mn>
           </mrow>
          </mrow>
          <mrow><mi>n</mi>
          </mrow>
         </msubsup><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <msub>
          <mrow><mi>x</mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow><mo>-</mo><mi>n</mi>
         <mfrac>
          <mrow><mi>a</mi>
          </mrow>
          <mrow><mi>b</mi>
          </mrow>
         </mfrac><mo>+</mo><mi>n</mi>
         <mfrac>
          <mrow><mn>1</mn>
          </mrow>
          <mrow>
           <msup>
            <mrow><mi>b</mi>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msup>
          </mrow>
         </mfrac>
         <mover>
          <mrow><mi>x</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover>
        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>,</mo><mspace width="6px" /><mspace width="6px" />
     <mstyle mathvariant='normal'>
      <mrow><mi>a</mi><mi>n</mi><mi>d</mi>
      </mrow>
     </mstyle><mspace width="6px" /><mspace width="6px" />
     <msubsup>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi> &ell; </mi>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo>-</mo><mi>n</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi> &psi; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
       <mtd>
        <mfrac>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mi>b</mi>
         </mrow>
        </mfrac>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mfrac>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mi>b</mi>
         </mrow>
        </mfrac>
       </mtd>
       <mtd>
        <mfrac>
         <mrow>
          <mrow><mn>2</mn>
           <mover>
            <mrow><mi>x</mi>
            </mrow><mo stretchy="true">&OverBar;</mo>
           </mover><mo>-</mo><mi>a</mi><mi>b</mi>
          </mrow>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>b</mi>
           </mrow>
           <mrow><mn>3</mn>
           </mrow>
          </msup>
         </mrow>
        </mfrac>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msubsup>
      <mrow><mi> &nabla; </mi>
      </mrow>
      <mrow><mi> &theta; </mi>
      </mrow>
      <mrow><mn>2</mn>
      </mrow>
     </msubsup>
     <msub>
      <mrow><mi> &ell; </mi>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo>-</mo><mi>n</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
     <mtable>
      <mtr>
       <mtd>
        <mrow>
         <msub>
          <mrow><mi> &psi; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
       <mtd>
        <mfrac>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mi>b</mi>
         </mrow>
        </mfrac>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mfrac>
         <mrow><mn>1</mn>
         </mrow>
         <mrow><mi>b</mi>
         </mrow>
        </mfrac>
       </mtd>
       <mtd>
        <mfrac>
         <mrow>
          <mrow><mn>2</mn>
           <mover>
            <mrow><mi>x</mi>
            </mrow><mo stretchy="true">&OverBar;</mo>
           </mover><mo>-</mo><mi>a</mi><mi>b</mi>
          </mrow>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi>b</mi>
           </mrow>
           <mrow><mn>3</mn>
           </mrow>
          </msup>
         </mrow>
        </mfrac>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>=</mo><mo>-</mo>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </mfrac>
     <mfrac>
      <mrow><mn>1</mn>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi> &psi; </mi>
         </mrow>
         <mrow><mn>1</mn>
         </mrow>
        </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        <mfrac>
         <mrow>
          <mrow><mn>2</mn>
           <mover>
            <mrow><mi>x</mi>
            </mrow><mo stretchy="true">&OverBar;</mo>
           </mover><mo>-</mo><mi>a</mi><mi>b</mi>
          </mrow>
         </mrow>
         <mrow><mi>b</mi>
         </mrow>
        </mfrac><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
     </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
     <mtable>
      <mtr>
       <mtd>
        <mfrac>
         <mrow>
          <mrow><mn>2</mn>
           <mover>
            <mrow><mi>x</mi>
            </mrow><mo stretchy="true">&OverBar;</mo>
           </mover><mo>-</mo><mi>a</mi><mi>b</mi>
          </mrow>
         </mrow>
         <mrow><mi>b</mi>
         </mrow>
        </mfrac>
       </mtd>
       <mtd>
        <mrow><mo>-</mo><mi>b</mi>
        </mrow>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow><mo>-</mo><mi>b</mi>
        </mrow>
       </mtd>
       <mtd>
        <mrow>
         <msup>
          <mrow><mi>b</mi>
          </mrow>
          <mrow><mn>2</mn>
          </mrow>
         </msup>
         <msub>
          <mrow><mi> &psi; </mi>
          </mrow>
          <mrow><mn>1</mn>
          </mrow>
         </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </mtd>
      </mtr>
     </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>+</mo>
   <msub>
    <mrow><mi> &eta; </mi>
    </mrow>
    <mrow><mi>t</mi>
    </mrow>
   </msub>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub>
      <msub>
       <mrow><mi> &ell; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msup>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup><mo>,</mo>
       <msup>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>Newton algorithm's recursion is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mi>t</mi><mo>+</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <msup>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </msup>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>+</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mrow>
        <msubsup>
         <mrow><mi> &nabla; </mi>
         </mrow>
         <mrow><mi> &theta; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msubsup><mi>C</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msup>
          <mrow><mi>a</mi>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup><mo>,</mo>
         <msup>
          <mrow><mi>b</mi>
          </mrow>
          <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

          </mrow>
         </msup>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
     </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <msub>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
      </msub>
      <msub>
       <mrow><mi> &ell; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow>
       <msup>
        <mrow><mi>a</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup><mo>,</mo>
       <msup>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>t</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
       </msup>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>where additionally<math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msubsup>
    <mrow><mi> &nabla; </mi>
    </mrow>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow><mn>2</mn>
    </mrow>
   </msubsup>
   <msub>
    <mrow><mi> &ell; </mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>=</mo><mo>-</mo><mi>n</mi><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <mrow>
       <msub>
        <mrow><mi> &psi; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mtd>
     <mtd>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi>b</mi>
       </mrow>
      </mfrac>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mfrac>
       <mrow><mn>1</mn>
       </mrow>
       <mrow><mi>b</mi>
       </mrow>
      </mfrac>
     </mtd>
     <mtd>
      <mfrac>
       <mrow>
        <mrow><mn>2</mn>
         <mover>
          <mrow><mi>x</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover><mo>-</mo><mi>a</mi><mi>b</mi>
        </mrow>
       </mrow>
       <mrow>
        <msup>
         <mrow><mi>b</mi>
         </mrow>
         <mrow><mn>3</mn>
         </mrow>
        </msup>
       </mrow>
      </mfrac>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo><mo>;</mo><mspace width="6px" /><mspace width="6px" />
   <mstyle mathvariant='normal'>
    <mrow><mi>h</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>e</mi>
    </mrow>
   </mstyle><mspace width="6px" /><mspace width="6px" />
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow>
      <msubsup>
       <mrow><mi> &nabla; </mi>
       </mrow>
       <mrow><mi> &theta; </mi>
       </mrow>
       <mrow><mn>2</mn>
       </mrow>
      </msubsup>
      <msub>
       <mrow><mi> &ell; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup><mo>=</mo><mo>-</mo>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </mfrac>
   <mfrac>
    <mrow><mn>1</mn>
    </mrow>
    <mrow>
     <mrow>
      <msub>
       <mrow><mi> &psi; </mi>
       </mrow>
       <mrow><mn>1</mn>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      <mfrac>
       <mrow>
        <mrow><mn>2</mn>
         <mover>
          <mrow><mi>x</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover><mo>-</mo><mi>a</mi><mi>b</mi>
        </mrow>
       </mrow>
       <mrow><mi>b</mi>
       </mrow>
      </mfrac><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </mfrac><mo form='prefix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>[</mo>
   <mtable>
    <mtr>
     <mtd>
      <mfrac>
       <mrow>
        <mrow><mn>2</mn>
         <mover>
          <mrow><mi>x</mi>
          </mrow><mo stretchy="true">&OverBar;</mo>
         </mover><mo>-</mo><mi>a</mi><mi>b</mi>
        </mrow>
       </mrow>
       <mrow><mi>b</mi>
       </mrow>
      </mfrac>
     </mtd>
     <mtd>
      <mrow><mo>-</mo><mi>b</mi>
      </mrow>
     </mtd>
    </mtr>
    <mtr>
     <mtd>
      <mrow><mo>-</mo><mi>b</mi>
      </mrow>
     </mtd>
     <mtd>
      <mrow>
       <msup>
        <mrow><mi>b</mi>
        </mrow>
        <mrow><mn>2</mn>
        </mrow>
       </msup>
       <msub>
        <mrow><mi> &psi; </mi>
        </mrow>
        <mrow><mn>1</mn>
        </mrow>
       </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi>a</mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
     </mtd>
    </mtr>
   </mtable><mo form='postfix' fence='true' stretchy='true' symmetric='true' lspace='thinmathspace'>]</mo>
  </mrow>
 </mrow></math> </div>
</div>
</div>

<div class="standard" id='magicparlabel-550'><br />

</div>
<h2 class="section" id='magicparlabel-551'><span class="section_label">B</span> Gaussian approximation of a (posterior) distribution <div class="marginal"><div class="plain_layout" id='magicparlabel-555'>Introduced 
<br />

in 
<br />

SI2</div>
</div></h2>

<div class="note" id='magicparlabel-556'><div class="note_item"><span class="note_label">Note 32.</span>
A well known approximation of the posterior distribution is the Gaussian posterior approximation. </div>
</div>

<div class="theorem" id='magicparlabel-557'><div class="theorem_item"><span class="theorem_label">Theorem 33.</span>
The posterior density <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo>
    <msub>
     <mrow><mi>z</mi>
     </mrow>
     <mrow>
      <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
      </mrow>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> given <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi>n</mi>
 </mrow></math> observables <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi>z</mi>
   </mrow>
   <mrow>
    <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
    </mrow>
   </mrow>
  </msub>
 </mrow></math> can be approximated by a multivariate Gaussian distribution density <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mo> Pr </mo>
    </mrow>
    <mrow>
     <mstyle mathvariant='normal'><mi>G</mi>
     </mstyle>
    </mrow>
   </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mo> &Sigma; </mo>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> with mean <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <msub>
   <mrow><mi> &mu; </mi>
   </mrow>
   <mrow><mi>n</mi>
   </mrow>
  </msub>
 </mrow></math> being the mode i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <mfrac>
       <mrow><mi> &part; </mi>
       </mrow>
       <mrow>
        <mrow><mi> &part; </mi>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi> &theta; </mi><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </msub><mo>=</mo><mn>0</mn>
  </mrow>
 </mrow></math>, and with covariance matrix <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mo> &Sigma; </mo>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>&gt;</mo><mn>0</mn>
  </mrow>
 </mrow></math> being the inverse Hessian at the mode i.e.<i> <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mo> &Sigma; </mo>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>=</mo>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>H</mi>
       </mrow>
       <mrow><mo> Pr </mo>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mrow><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>[</mo>

     <mrow>
      <msub>
       <mrow><mi>H</mi>
       </mrow>
       <mrow><mo> Pr </mo>
       </mrow>
      </msub><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>]</mo>

    </mrow>
    <mrow>
     <mrow><mi>i</mi><mo>,</mo><mi>j</mi>
     </mrow>
    </mrow>
   </msub><mo>=</mo>
   <msub>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

     <mrow>
      <mfrac>
       <mrow>
        <msup>
         <mrow><mi> &part; </mi>
         </mrow>
         <mrow><mn>2</mn>
         </mrow>
        </msup>
       </mrow>
       <mrow>
        <mrow><mi> &part; </mi>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mi>i</mi>
          </mrow>
         </msub><mi> &part; </mi>
         <msub>
          <mrow><mi> &theta; </mi>
          </mrow>
          <mrow><mi>j</mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
      </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

       <mrow><mi> &theta; </mi><mo>|</mo>
        <msub>
         <mrow><mi>z</mi>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>:</mo><mi>n</mi>
          </mrow>
         </mrow>
        </msub>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

    </mrow>
    <mrow>
     <mrow><mi> &theta; </mi><mo>=</mo>
      <msub>
       <mrow><mi> &mu; </mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub>
     </mrow>
    </mrow>
   </msub>
  </mrow>
 </mrow></math>. </i></div>
</div>

<div class="example" id='magicparlabel-558'><div class="example_item"><span class="example_label">Example 34.</span>
Consider a Bayesian model with sampling distribution <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>x</mi>
    </mrow>
    <mrow><mi>i</mi>
    </mrow>
   </msub><mo>|</mo><mi> &theta; </mi><mover accent='false'><mo> &sim; </mo>
   <mstyle mathvariant='normal'>
    <mrow><mi>i</mi><mi>i</mi><mi>d</mi>
    </mrow>
   </mstyle></mover><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>x</mi>
     </mrow>
     <mrow><mi>i</mi>
     </mrow>
    </msub><mo>|</mo><mi> &theta; </mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow>
     <msub>
      <mrow><mi>x</mi>
      </mrow>
      <mrow><mi>i</mi>
      </mrow>
     </msub>
    </mrow>
   </msup>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>-</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mrow>
      <msub>
       <mrow><mi>x</mi>
       </mrow>
       <mrow><mi>i</mi>
       </mrow>
      </msub><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math> and prior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi> &theta; </mi><mo> &sim; </mo><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &vprop; </mo>
   <msup>
    <mrow><mi> &theta; </mi>
    </mrow>
    <mrow>
     <mrow><mi>a</mi><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
   <msup>
    <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>-</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
    <mrow>
     <mrow><mi>b</mi><mo>-</mo><mn>1</mn>
     </mrow>
    </mrow>
   </msup>
  </mrow>
 </mrow></math>. Find the Gaussian approximation of the posterior <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math> of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> given <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mi>x</mi><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi>x</mi>
     </mrow>
     <mrow><mn>1</mn>
     </mrow>
    </msub><mo>,</mo><mn>...</mn><mo>,</mo>
    <msub>
     <mrow><mi>x</mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>

<div class="solution_" id='magicparlabel-563'><div class="solution__item"><span class="solution__label">Solution.</span>
The log posterior density is <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

      <mrow><mi> &theta; </mi><mo>|</mo><mi>x</mi>
      </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
   <mtd>
    <mrow><mo>=</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>a</mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo>-</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>
<mi> &theta; </mi>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo>+</mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow>
      <msub>
       <mrow><mi>b</mi>
       </mrow>
       <mrow><mi>n</mi>
       </mrow>
      </msub><mo>-</mo><mn>1</mn>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

     <mrow><mn>1</mn><mo>-</mo><mi> &theta; </mi>
     </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

    </mrow>
   </mtd>
  </mtr>
 </mtable></math>where <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>a</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>=</mo><mi>a</mi><mo>+</mo><mi>n</mi>
   <mover>
    <mrow><mi>x</mi>
    </mrow><mo stretchy="true">&OverBar;</mo>
   </mover>
  </mrow>
 </mrow></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <msub>
    <mrow><mi>b</mi>
    </mrow>
    <mrow><mi>n</mi>
    </mrow>
   </msub><mo>=</mo><mi>b</mi><mo>+</mo><mi>n</mi><mo>-</mo><mi>n</mi>
   <mover>
    <mrow><mi>x</mi>
    </mrow><mo stretchy="true">&OverBar;</mo>
   </mover>
  </mrow>
 </mrow></math>. So <math display="block" xmlns="http://www.w3.org/1998/Math/MathML">
 <mtable>
  <mtr>
   <mtd>
    <mrow><mn>0</mn><mo>=</mo>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mrow>
        <mfrac>
         <mrow>
          <mstyle mathvariant='normal'><mi>d</mi>
          </mstyle>
         </mrow>
         <mrow>
          <mrow>
           <mstyle mathvariant='normal'><mi>d</mi>
           </mstyle><mi> &theta; </mi>
          </mrow>
         </mrow>
        </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi> &theta; </mi><mo>|</mo><mi>x</mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi> &theta; </mi><mo>=</mo>
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msub><mo>=</mo>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mrow>
        <mfrac>
         <mrow>
          <mrow>
           <msub>
            <mrow><mi>a</mi>
            </mrow>
            <mrow><mi>n</mi>
            </mrow>
           </msub><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow><mi> &theta; </mi>
         </mrow>
        </mfrac><mo>-</mo>
        <mfrac>
         <mrow>
          <mrow>
           <msub>
            <mrow><mi>b</mi>
            </mrow>
            <mrow><mi>n</mi>
            </mrow>
           </msub><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow>
          <mrow><mn>1</mn><mo>-</mo><mi> &theta; </mi>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi> &theta; </mi><mo>=</mo>
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd><mo> &#x27F9; </mo>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow><mi> &mu; </mi>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>a</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo>-</mo><mn>1</mn>
       </mrow>
      </mrow>
      <mrow>
       <mrow>
        <msub>
         <mrow><mi>a</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi>b</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo>-</mo><mn>2</mn>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
  </mtr>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mrow><mo> &Sigma; </mo>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo>=</mo>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mrow>
        <mfrac>
         <mrow>
          <msup>
           <mrow>
            <mstyle mathvariant='normal'><mi>d</mi>
            </mstyle>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
         <mrow>
          <mrow>
           <mstyle mathvariant='normal'><mi>d</mi>
           </mstyle>
           <msup>
            <mrow><mi> &theta; </mi>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msup>
          </mrow>
         </mrow>
        </mfrac><mo> log </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

         <mrow><mi> &theta; </mi><mo>|</mo><mi>x</mi>
         </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi> &theta; </mi><mo>=</mo>
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msub><mo>=</mo>
     <msub>
      <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>.</mo>

       <mrow>
        <mfrac>
         <mrow>
          <mrow>
           <msub>
            <mrow><mi>a</mi>
            </mrow>
            <mrow><mi>n</mi>
            </mrow>
           </msub><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow>
          <msup>
           <mrow><mi> &theta; </mi>
           </mrow>
           <mrow><mn>2</mn>
           </mrow>
          </msup>
         </mrow>
        </mfrac><mo>-</mo>
        <mfrac>
         <mrow>
          <mrow>
           <msub>
            <mrow><mi>b</mi>
            </mrow>
            <mrow><mi>n</mi>
            </mrow>
           </msub><mo>-</mo><mn>1</mn>
          </mrow>
         </mrow>
         <mrow>
          <mrow><mo>(</mo><mn>1</mn><mo>-</mo><mi> &theta; </mi>
           <msup>
            <mrow><mo>)</mo>
            </mrow>
            <mrow><mn>2</mn>
            </mrow>
           </msup>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>|</mo>

      </mrow>
      <mrow>
       <mrow><mi> &theta; </mi><mo>=</mo>
        <msub>
         <mrow><mi> &mu; </mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
     </msub>
    </mrow>
   </mtd>
   <mtd><mo> &#x27F9; </mo>
   </mtd>
   <mtd>
    <mrow>
     <msub>
      <mrow><mo> &Sigma; </mo>
      </mrow>
      <mrow><mi>n</mi>
      </mrow>
     </msub><mo>=</mo>
     <mfrac>
      <mrow>
       <mrow><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>a</mi>
          </mrow>
          <mrow><mi>n</mi>
          </mrow>
         </msub><mo>-</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

        <mrow>
         <msub>
          <mrow><mi>b</mi>
          </mrow>
          <mrow><mi>n</mi>
          </mrow>
         </msub><mo>-</mo><mn>1</mn>
        </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

       </mrow>
      </mrow>
      <mrow>
       <mrow><mo>(</mo>
        <msub>
         <mrow><mi>a</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo>+</mo>
        <msub>
         <mrow><mi>b</mi>
         </mrow>
         <mrow><mi>n</mi>
         </mrow>
        </msub><mo>-</mo><mn>2</mn>
        <msup>
         <mrow><mo>)</mo>
         </mrow>
         <mrow><mn>3</mn>
         </mrow>
        </msup>
       </mrow>
      </mrow>
     </mfrac>
    </mrow>
   </mtd>
  </mtr>
 </mtable></math> Therefore, <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow><mi> &theta; </mi>
 </mrow></math> has asymptotic posterior density is that of <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mo> &Sigma; </mo>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>; i.e. <math xmlns="http://www.w3.org/1998/Math/MathML">
 <mrow>
  <mrow><mo> Pr </mo><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo><mi>x</mi>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>
<mo> &ap; </mo>
   <mstyle mathvariant='normal'><mi>N</mi>
   </mstyle><mo form='prefix' fence='true' stretchy='true' symmetric='true'>(</mo>

   <mrow><mi> &theta; </mi><mo>|</mo>
    <msub>
     <mrow><mi> &mu; </mi>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub><mo>,</mo>
    <msub>
     <mrow><mo> &Sigma; </mo>
     </mrow>
     <mrow><mi>n</mi>
     </mrow>
    </msub>
   </mrow>
<mo form='postfix' fence='true' stretchy='true' symmetric='true'>)</mo>

  </mrow>
 </mrow></math>.</div>
</div>
</div>

<div class="standard" id='magicparlabel-564'><br />

</div>
</body>
</html>
